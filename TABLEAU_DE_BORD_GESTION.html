<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Gestion Avancée</title>
    
    <!-- Utilisation de la police Inter via Google Fonts pour un look moderne -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    
    <style>
        /* ------------------------------------------------------------------ */
        /* BASE & LAYOUT */
        /* ------------------------------------------------------------------ */
        body, html { margin: 0; padding: 0; height: 100%; font-family: 'Inter', sans-serif; background: #0A0A10; color: #EAEAEA; overflow: hidden; }
        
        .dashboard-wrapper { display: flex; flex-direction: column; height: 100vh; }
        .header { background: #151520; padding: 20px 30px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4); display: flex; justify-content: space-between; align-items: center; }
        .header h1 { color: #FF0000; font-size: 1.8em; margin: 0; }
        .header p { color: #FFD700; font-weight: 500; margin: 0; font-size: 0.9em; }

        /* NOUVELLE NAVIGATION PAR ONGLETS (Design plus intégré et moderne) */
        .tabs { 
            display: flex; 
            padding: 0 30px; 
            background: #1C1C2C; /* Garde le fond sombre pour contraster avec le header */
            border-bottom: none; /* Supprime la ligne de séparation nette */
        }
        .tab-button {
            padding: 15px 20px;
            cursor: pointer;
            color: #B0B0D0;
            font-weight: 600;
            transition: color 0.3s, background 0.3s;
            border-radius: 8px 8px 0 0; /* Ajout d'arrondis en haut */
            margin-right: 5px; 
            position: relative;
            overflow: hidden;
            border-bottom: 3px solid transparent; /* Ligne par défaut */
        }
        .tab-button:hover {
            color: white;
            background: #25253A;
        }
        .tab-button.active {
            color: white;
            background: #0A0A10; /* Fait correspondre le fond du contenu principal pour un effet "découpé" */
            box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.2); /* Soulève légèrement l'onglet actif */
            z-index: 1; 
            border-bottom: 3px solid #FF0000; /* Nouvelle ligne active rouge */
        }
        /* Correction de la transition pour le contenu principal */
        .main-content { 
            flex-grow: 1; 
            padding: 30px; 
            overflow-y: auto; 
            background: #0A0A10; 
            margin-top: -1px; /* Chevauche légèrement pour un raccord lisse */
            position: relative;
        }
        .tab-content { display: none; padding: 0; }
        .tab-content.active { display: block; }
        
        /* ------------------------------------------------------------------ */
        /* WIDGETS & INDICATORS (Nouveau style avec barre latérale) */
        /* ------------------------------------------------------------------ */
        .widget-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .indicator-card { 
            background: #1C1C2C; 
            padding: 25px 25px 25px 35px; /* Augmente le padding à gauche pour la barre */
            border-radius: 12px; 
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
            transition: transform 0.2s, box-shadow 0.3s; 
            position: relative;
            border-left: none !important; /* Supprime l'ancienne barre latérale */
        }
        /* Barre colorée sur la gauche */
        .indicator-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 6px;
            border-radius: 12px 0 0 12px;
        }

        .indicator-card:hover { transform: translateY(-3px); box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5); }
        .indicator-card h3 { margin: 0 0 10px 0; font-size: 0.9em; color: #AAAAAA; font-weight: 500; }
        .indicator-card p { font-size: 2.5em; font-weight: 700; margin: 0; line-height: 1; }
        
        /* Financial Colors */
        .revenue-card::after { background: #4CAF50; }
        .expense-card::after { background: #FF6347; }
        .stock-card::after { background: #4D96FF; }
        .profit-card::after { background: #FFD700; }

        .revenue-card p { color: #4CAF50; }
        .expense-card p { color: #FF6347; }
        .stock-card p { color: #4D96FF; }
        .profit-card p { color: #FFD700; }

        /* ------------------------------------------------------------------ */
        /* INPUT PANEL / FORMS */
        /* ------------------------------------------------------------------ */
        .input-panel { background: #1C1C2C; padding: 30px; border-radius: 12px; margin-top: 20px; }
        .input-panel h2 { color: white; border-bottom: none; margin-top: 0; margin-bottom: 20px; font-size: 1.4em; }
        .input-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; }
        .input-group label { display: block; font-size: 0.85em; margin-bottom: 5px; color: #B0B0D0; }
        .input-group input, .input-group select { 
            width: 100%; padding: 12px; border-radius: 8px; border: 1px solid #33334F; 
            background: #0A0A10; color: white; font-size: 1em; box-sizing: border-box; 
        }
        
        #save-button, #add-event-button { 
            background: #FF0000; color: white; padding: 15px; border: none; border-radius: 8px; 
            font-size: 1.1em; font-weight: bold; cursor: pointer; width: 100%; margin-top: 25px; 
            transition: background 0.3s; 
        }
        #save-button:hover, #add-event-button:hover { background: #cc0000; }

        /* Style pour le bouton d'ajout de client */
        #add-client-button { 
            background: #4D96FF; 
            color: white; 
            padding: 10px; 
            border: none; 
            border-radius: 8px; 
            font-size: 1em; 
            font-weight: bold; 
            cursor: pointer; 
            transition: background 0.3s; 
        }
        #add-client-button:hover { background: #3c78d8; }

        .client-delete-btn {
            background: #FF6347; 
            color: white; 
            padding: 5px 10px; 
            border: none; 
            border-radius: 4px; 
            font-size: 0.9em;
            cursor: pointer;
            transition: background 0.2s;
        }
        .client-delete-btn:hover {
            background: #cc4f38;
        }


        /* ------------------------------------------------------------------ */
        /* CALENDAR & EVENT STYLES */
        /* ------------------------------------------------------------------ */
        .calendar-container { max-width: 900px; margin-top: 20px; background: #1C1C2C; padding: 25px; border-radius: 12px; }
        .calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .calendar-header button { background: none; border: none; color: #FFD700; font-size: 1.5em; cursor: pointer; transition: color 0.2s; }
        .calendar-header button:hover { color: #FF0000; }
        #month-year-display { font-size: 1.4em; font-weight: 600; }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); text-align: center; }
        .day-name { font-size: 0.8em; color: #AAAAAA; padding: 10px 0; font-weight: 600; }
        .calendar-day { 
            padding: 10px 0; 
            cursor: pointer; 
            border-radius: 50%; 
            transition: background 0.2s;
            margin: 2px;
            line-height: 1.2;
        }
        .calendar-day:not(.empty-day):hover { background: #25253A; }
        .today { border: 2px solid #4CAF50; background: #223322 !important; color: #4CAF50; }
        .has-event { background: #3A2020; border: 1px solid #FF0000; }
        .selected-day { background-color: #33334F !important; }
        
        #event-display { margin-top: 25px; padding: 20px; background: #0A0A10; border-radius: 10px; }
        #event-display h3 { color: #FF0000; margin-top: 0; font-size: 1.2em; }
        #event-list-message { color:#B0B0D0; font-size:0.9em; }
        
        #event-list { list-style: none; padding: 0; text-align: left; }
        #event-list li { 
            margin-bottom: 15px; 
            border-left: 5px solid #FF0000; 
            padding: 10px; 
            background: #151520;
            border-radius: 8px;
            font-size: 1em; 
            display: flex; 
            justify-content: space-between; 
            align-items: flex-start; 
        }
        #event-list li .details { flex-grow: 1; }
        #event-list li .details strong { color: #FFD700; }
        #event-list li .details p { margin: 4px 0 0 0; font-size: 0.9em; color: #B0B0D0; }
        
        .delete-btn { background: none; border: none; color: #FF6347; cursor: pointer; font-weight: bold; margin-left: 10px; font-size: 1.2em; align-self: center;}
        
        /* Styles spécifiques pour le formulaire de commande */
        .order-form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px 20px;
        }
        .full-width {
            grid-column: 1 / -1;
        }

        /* ------------------------------------------------------------------ */
        /* TRANSACTION HISTORY / CLIENTS TABLE */
        /* ------------------------------------------------------------------ */
        .history-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .history-table th, .history-table td { padding: 15px; text-align: left; border-bottom: 1px solid #33334F; }
        .history-table th { background: #1C1C2C; color: #FFD700; font-weight: 600; text-transform: uppercase; font-size: 0.85em; }
        .history-table tr:hover { background: #151520; }
        .revenue-text { color: #4CAF50; font-weight: 600; }
        .expense-text { color: #FF6347; font-weight: 600; }
        .stock-text { color: #4D96FF; font-weight: 600; }

        /* ------------------------------------------------------------------ */
        /* SECURITY OVERLAY (BUG FIX) */
        /* ------------------------------------------------------------------ */
        #content-area { 
            display: block; 
            height: 100%; 
        }
        #security-check { 
            display: none !important; 
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); 
            max-width: 450px; padding: 40px; background: #1C1C2C; border-radius: 15px; 
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6); border: 1px solid #33334F; 
            text-align: center; color: #E0E0E0; z-index: 999; 
        }
    </style>
</head>
<body>
    <!-- Écran de sécurité caché -->
    <div id="security-check">
        <!-- Contenu caché -->
    </div>
    
    <div id="content-area">
        <div class="dashboard-wrapper">
            
            <!-- En-tête Global -->
            <div class="header">
                <h1>RED BULL GOLD - Dashboard de Gestion</h1>
                <p id="current-datetime"></p>
            </div>

            <!-- Navigation par Onglets -->
            <div class="tabs">
                <div class="tab-button active" onclick="openTab('gestion')">📈 Gestion Financière & Stock</div>
                <div class="tab-button" onclick="openTab('calendrier')">📅 Commandes Planifiées</div>
                <div class="tab-button" onclick="openTab('historique')">📜 Historique des Transactions</div>
                <div class="tab-button" onclick="openTab('clients')">👥 Clients & Contacts</div>
            </div>

            <div class="main-content">
                
                <!-- ----------------------------------------------------------- -->
                <!-- ONGLET 1: GESTION FINANCIÈRE & STOCK -->
                <!-- ----------------------------------------------------------- -->
                <div id="gestion" class="tab-content active">
                    
                    <h2>Indicateurs Clés du Mois</h2>
                    <!-- Indicateurs Clés -->
                    <div class="widget-grid">
                        <div class="indicator-card revenue-card">
                            <h3>Revenus Totaux (€)</h3>
                            <p id="display-revenue">0,00</p>
                        </div>
                        <div class="indicator-card expense-card">
                            <h3>Dépenses Totales (€)</h3>
                            <p id="display-expense">0,00</p>
                        </div>
                        <div class="indicator-card profit-card">
                            <h3>Bénéfice Net (€)</h3>
                            <p id="display-profit">0,00</p>
                        </div>
                        <div class="indicator-card stock-card">
                            <h3>Stock Actuel (Packs)</h3>
                            <p id="display-stock">0</p>
                        </div>
                    </div>

                    <!-- Panneau de Saisie -->
                    <div class="input-panel">
                        <h2>Enregistrement de Nouvelle Transaction</h2>
                        <div class="input-grid">
                            
                            <div class="input-group">
                                <label for="input-revenue">Nouveau Revenu (€)</label>
                                <input type="number" id="input-revenue" placeholder="0.00" value="0.00" min="0">
                            </div>
                            
                            <div class="input-group">
                                <label for="input-expense">Nouvelle Dépense (€)</label>
                                <input type="number" id="input-expense" placeholder="0.00" value="0.00" min="0">
                            </div>

                            <div class="input-group">
                                <label for="input-expense-category">Catégorie Dépense</label>
                                <select id="input-expense-category">
                                    <option value="Aucune">-- Optionnel --</option>
                                    <option value="Achat Stock">Achat Stock</option>
                                    <option value="Frais Publicité">Frais Publicité</option>
                                    <option value="Frais Divers">Frais Divers</option>
                                </select>
                            </div>

                            <div class="input-group">
                                <label for="input-stock-in">Stock Reçu (+ Packs)</label>
                                <input type="number" id="input-stock-in" placeholder="0" value="0" min="0">
                            </div>
                            <div class="input-group">
                                <label for="input-stock-out">Stock Vendu (- Packs)</label>
                                <input type="number" id="input-stock-out" placeholder="0" value="0" min="0">
                            </div>
                            <div class="input-group">
                                <label for="input-description">Description (Optionnel)</label>
                                <input type="text" id="input-description" maxlength="50" placeholder="Ex: Vente Pierre ou Commande Grossiste">
                            </div>

                        </div>
                        <button id="save-button" onclick="saveTransaction()">Enregistrer la Transaction & Mettre à jour</button>
                        <p style="font-size: 0.8em; margin-top: 15px; color: #AAAAAA; text-align: center;">*Toutes les données sont stockées dans le navigateur de cet appareil. Ne pas effacer le cache.</p>
                    </div>

                </div>
                
                <!-- ----------------------------------------------------------- -->
                <!-- ONGLET 2: COMMANDES PLANIFIÉES (CALENDRIER) -->
                <!-- ----------------------------------------------------------- -->
                <div id="calendrier" class="tab-content">
                    
                    <h2>📅 Gestion du Calendrier des Commandes</h2>

                    <!-- Vue Calendrier -->
                    <div class="calendar-container">
                        <div class="calendar-header">
                            <button onclick="changeMonth(-1)">&#9664; Mois Précédent</button>
                            <span id="month-year-display"></span>
                            <button onclick="changeMonth(1)">Mois Suivant &#9654;</button>
                        </div>

                        <div class="calendar-grid" id="calendar-grid">
                            <div class="day-name">Lun</div><div class="day-name">Mar</div><div class="day-name">Mer</div>
                            <div class="day-name">Jeu</div><div class="day-name">Ven</div><div class="day-name">Sam</div>
                            <div class="day-name">Dim</div>
                            <!-- Jours du mois (générés par JS) -->
                        </div>

                        <!-- Affichage des commandes et Formulaire de saisie -->
                        <div id="event-display">
                            <h3 id="event-date-title">Sélectionnez un jour</h3>
                            <p id="event-list-message">Aucune commande planifiée pour cette date.</p>
                            <ul id="event-list"></ul>
                            
                            <!-- NOUVEAU FORMULAIRE DE COMMANDE -->
                            <div class="input-panel" style="background: #1C1C2C; padding: 20px; border-radius: 8px;">
                                <h4>Planifier une Nouvelle Commande</h4>
                                <div class="order-form-grid">
                                    <div class="input-group">
                                        <label for="order-client">Client</label>
                                        <select id="order-client" required>
                                            <option value="">-- Sélectionnez un Client --</option>
                                            <!-- Les clients seront injectés ici par JS -->
                                        </select>
                                        <small style="color: #FFD700;">(Si la liste est vide, allez à l'onglet "Clients" pour en ajouter)</small>
                                    </div>
                                    <div class="input-group">
                                        <label for="order-amount">Montant à Payer (€)</label>
                                        <input type="number" id="order-amount" placeholder="0.00" min="0" required>
                                    </div>
                                    <div class="input-group">
                                        <label for="order-packs">Quantité (Packs)</label>
                                        <input type="number" id="order-packs" placeholder="0" min="0" required>
                                    </div>
                                    <div class="input-group">
                                        <label for="order-item-description">Description de l'Article</label>
                                        <input type="text" id="order-item-description" placeholder="Ex: Red Bull Gold, 50cl, etc." maxlength="50" required>
                                    </div>
                                    <div class="input-group full-width">
                                        <button id="add-event-button" onclick="addOrder()" style="margin-top: 5px;">Ajouter la Commande au jour sélectionné</button>
                                    </div>
                                </div>
                            </div>
                            <!-- FIN NOUVEAU FORMULAIRE -->
                        </div>
                    </div>
                </div>

                <!-- ----------------------------------------------------------- -->
                <!-- ONGLET 3: HISTORIQUE DES TRANSACTIONS -->
                <!-- ----------------------------------------------------------- -->
                <div id="historique" class="tab-content">
                    <h2>📜 Liste des Transactions Enregistrées</h2>
                    <table class="history-table">
                        <thead>
                            <tr>
                                <th>Date/Heure</th>
                                <th>Description</th>
                                <th>Revenu (€)</th>
                                <th>Dépense (€)</th>
                                <th>Catégorie</th>
                                <th>Stock (+/- Packs)</th>
                            </tr>
                        </thead>
                        <tbody id="history-body">
                            <!-- Les lignes de l'historique seront insérées ici par JS -->
                        </tbody>
                    </table>
                    <p id="no-history-message" style="margin-top: 20px; color: #B0B0D0; text-align: center;">Aucune transaction enregistrée pour le moment.</p>
                </div>

                <!-- ----------------------------------------------------------- -->
                <!-- ONGLET 4: GESTION DES CLIENTS -->
                <!-- ----------------------------------------------------------- -->
                <div id="clients" class="tab-content">
                    
                    <h2>👥 Gestion des Contacts Clients</h2>

                    <div class="input-panel" style="margin-top: 0;">
                        <h3>Ajouter un Nouveau Client</h3>
                        <div class="input-grid" style="grid-template-columns: 1fr 1fr 200px;">
                            
                            <div class="input-group">
                                <label for="client-name">Nom du Client / Contact <span style="color: #FF0000;">*</span></label>
                                <input type="text" id="client-name" placeholder="Ex: Pierre Dubois" maxlength="50">
                            </div>
                            
                            <div class="input-group">
                                <label for="client-contact">Téléphone / Email / Notes (Optionnel)</label>
                                <input type="text" id="client-contact" placeholder="Ex: 06 XX XX XX XX ou note">
                            </div>

                            <div class="input-group" style="align-self: end;">
                                <button id="add-client-button" onclick="addClient()" style="margin-top: 0; width: 100%; height: 48px;">Ajouter le Client</button>
                            </div>

                        </div>
                    </div>

                    <div class="input-panel" style="margin-top: 20px;">
                        <h3>Liste des Clients Actuels</h3>
                        <table class="history-table client-table">
                            <thead>
                                <tr>
                                    <th style="width: 30%;">Nom du Client</th>
                                    <th style="width: 40%;">Contact / Notes</th>
                                    <th style="width: 20%;">Date d'Ajout</th>
                                    <th style="width: 10%;">Action</th>
                                </tr>
                            </thead>
                            <tbody id="client-list-body">
                                <!-- Liste des clients générée par JS -->
                            </tbody>
                        </table>
                        <p id="no-clients-message" style="margin-top: 20px; color: #B0B0D0; text-align: center; display: none;">Aucun client enregistré pour le moment.</p>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script>
        // ####################################################################
        // ########## PARAMÈTRES & LOGIQUE ###################################
        // ####################################################################
        
        // Constantes
        const NOW = new Date();
        const monthNames = ["Janvier", "Février", "Mars", "Avril", "Mai", "Juin", "Juillet", "Août", "Septembre", "Octobre", "Novembre", "Décembre"];
        
        // Variables d'état
        let currentMonth = NOW.getMonth();
        let currentYear = NOW.getFullYear();
        let selectedDate = null;
        
        let state = {
            revenue: 0,
            expense: 0,
            stock: 0,
            // Les événements stockent maintenant des objets complexes
            events: {}, // Structure: {'YYYY-MM-DD': [{clientId: 123, amount: 15.00, packs: 5, item: 'RB Gold 50cl'}, ...]}
            history: [], 
            clients: [] 
        };

        // Fonction d'initialisation au chargement
        document.addEventListener('DOMContentLoaded', () => {
            loadData();
            updateDateTime();
            setInterval(updateDateTime, 1000); 
            renderCalendar();
            // Assure que l'onglet 'gestion' est actif au démarrage
            openTab('gestion'); 
        });
        
        function updateDateTime() {
            const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit' };
            const now = new Date();
            document.getElementById('current-datetime').textContent = `${now.toLocaleDateString('fr-FR', dateOptions)} ${now.toLocaleTimeString('fr-FR', timeOptions)}`;
        }

        // ########## LOGIQUE DES ONGLETS ###################################
        function openTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });

            document.getElementById(tabName).classList.add('active');
            document.querySelector(`.tab-button[onclick="openTab('${tabName}')"]`).classList.add('active');
            
            if (tabName === 'historique') {
                renderHistory();
            } else if (tabName === 'clients') {
                renderClients();
            } else if (tabName === 'calendrier') {
                // S'assure que la liste des clients pour la commande est à jour
                populateClientSelect();
            }
        }


        // ########## GESTION DES DONNÉES ET STOCKAGE LOCAL #################

        function loadData() {
            // Charge les totaux
            state.revenue = parseFloat(localStorage.getItem('rbl_total_revenue') || '0');
            state.expense = parseFloat(localStorage.getItem('rbl_total_expense') || '0');
            state.stock = parseInt(localStorage.getItem('rbl_current_stock') || '0');

            try {
                const storedEvents = localStorage.getItem('rbl_calendar_events');
                if (storedEvents) { state.events = JSON.parse(storedEvents); }
                
                const storedHistory = localStorage.getItem('rbl_transaction_history');
                if (storedHistory) { state.history = JSON.parse(storedHistory); }

                const storedClients = localStorage.getItem('rbl_client_list');
                if (storedClients) { state.clients = JSON.parse(storedClients); }

            } catch (e) {
                console.error("Erreur lors du chargement des données :", e);
            }
            
            updateDisplay();
        }

        function saveData() {
            localStorage.setItem('rbl_total_revenue', state.revenue);
            localStorage.setItem('rbl_total_expense', state.expense);
            localStorage.setItem('rbl_current_stock', state.stock);
            localStorage.setItem('rbl_transaction_history', JSON.stringify(state.history));
            localStorage.setItem('rbl_calendar_events', JSON.stringify(state.events));
            localStorage.setItem('rbl_client_list', JSON.stringify(state.clients));
        }

        function updateDisplay() {
            // Mise à jour des indicateurs clés
            const profit = state.revenue - state.expense;
            document.getElementById('display-revenue').textContent = state.revenue.toFixed(2).replace('.', ',') + ' €';
            document.getElementById('display-expense').textContent = state.expense.toFixed(2).replace('.', ',') + ' €';
            document.getElementById('display-profit').textContent = profit.toFixed(2).replace('.', ',') + ' €';
            document.getElementById('display-stock').textContent = state.stock + ' Packs';
        }

        function saveTransaction() {
            const revenueInput = parseFloat(document.getElementById('input-revenue').value) || 0;
            const expenseInput = parseFloat(document.getElementById('input-expense').value) || 0;
            const stockInInput = parseInt(document.getElementById('input-stock-in').value) || 0;
            const stockOutInput = parseInt(document.getElementById('input-stock-out').value) || 0;
            const category = document.getElementById('input-expense-category').value;
            const description = document.getElementById('input-description').value.trim();

            if (revenueInput === 0 && expenseInput === 0 && stockInInput === 0 && stockOutInput === 0) {
                 alert("Veuillez entrer au moins une valeur non nulle.");
                 return;
            }

            // Mise à jour de l'état (totaux)
            state.revenue += revenueInput;
            state.expense += expenseInput;
            state.stock = state.stock + stockInInput - stockOutInput;
            
            // Création de l'objet transaction
            const transaction = {
                id: Date.now(),
                timestamp: new Date().toISOString(),
                revenue: revenueInput,
                expense: expenseInput,
                stockChange: stockInInput - stockOutInput,
                category: expenseInput > 0 ? category : 'N/A',
                description: description || (revenueInput > 0 ? 'Revenu' : (expenseInput > 0 ? 'Dépense' : 'Stock')),
            };
            state.history.unshift(transaction); // Ajouter en début de liste

            // Sauvegarde & Affichage
            saveData();
            updateDisplay();

            // Réinitialiser les champs de saisie
            document.getElementById('input-revenue').value = '0.00';
            document.getElementById('input-expense').value = '0.00';
            document.getElementById('input-stock-in').value = '0';
            document.getElementById('input-stock-out').value = '0';
            document.getElementById('input-expense-category').value = 'Aucune';
            document.getElementById('input-description').value = '';

            alert('Transaction enregistrée avec succès !');
        }

        // ########## HISTORIQUE ###################################
        function renderHistory() {
            const tbody = document.getElementById('history-body');
            tbody.innerHTML = '';

            if (state.history.length === 0) {
                document.getElementById('no-history-message').style.display = 'block';
                return;
            } else {
                 document.getElementById('no-history-message').style.display = 'none';
            }
            
            // Trie l'historique par date (du plus récent au plus ancien)
            const sortedHistory = [...state.history].sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));

            sortedHistory.forEach(t => {
                const tr = document.createElement('tr');
                const date = new Date(t.timestamp);

                tr.innerHTML = `
                    <td>${date.toLocaleDateString('fr-FR')} ${date.toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' })}</td>
                    <td>${t.description}</td>
                    <td class="${t.revenue > 0 ? 'revenue-text' : ''}">${t.revenue > 0 ? '+' + t.revenue.toFixed(2).replace('.', ',') + ' €' : '-'}</td>
                    <td class="${t.expense > 0 ? 'expense-text' : ''}">${t.expense > 0 ? '-' + t.expense.toFixed(2).replace('.', ',') + ' €' : '-'}</td>
                    <td>${t.category}</td>
                    <td class="${t.stockChange !== 0 ? 'stock-text' : ''}">${t.stockChange > 0 ? '+' : ''}${t.stockChange !== 0 ? t.stockChange : '-'}</td>
                `;
                tbody.appendChild(tr);
            });
        }


        // ########## GESTION DES CLIENTS #########################
        
        function renderClients() {
            const tbody = document.getElementById('client-list-body');
            tbody.innerHTML = '';
            
            if (state.clients.length === 0) {
                document.getElementById('no-clients-message').style.display = 'block';
                return;
            } else {
                 document.getElementById('no-clients-message').style.display = 'none';
            }

            // Trie les clients par nom
            const sortedClients = [...state.clients].sort((a, b) => a.name.localeCompare(b.name));

            sortedClients.forEach((client) => {
                const tr = document.createElement('tr');
                const date = new Date(client.timestamp);

                tr.innerHTML = `
                    <td>${client.name}</td>
                    <td>${client.contact || '-'}</td>
                    <td>${date.toLocaleDateString('fr-FR')}</td>
                    <td><button class="client-delete-btn" onclick="deleteClient(${client.id})">Supprimer</button></td>
                `;
                tbody.appendChild(tr);
            });
        }

        function addClient() {
            const nameInput = document.getElementById('client-name');
            const contactInput = document.getElementById('client-contact');
            
            const name = nameInput.value.trim();
            const contact = contactInput.value.trim();

            if (!name) {
                 alert("Le nom du client est obligatoire.");
                 return;
            }

            const newClient = {
                id: Date.now(), 
                name: name,
                contact: contact,
                timestamp: new Date().toISOString(),
            };
            
            state.clients.push(newClient); 

            saveData();
            renderClients();
            populateClientSelect(); // Met à jour le sélecteur de commandes

            nameInput.value = '';
            contactInput.value = '';

            alert(`Client "${name}" ajouté avec succès !`);
        }
        
        function deleteClient(clientId) {
            if (confirm("Êtes-vous sûr de vouloir supprimer ce client de la liste ?")) {
                const initialLength = state.clients.length;
                state.clients = state.clients.filter(client => client.id !== clientId);
                
                if (state.clients.length < initialLength) {
                    // Supprimer également toutes les commandes associées (robustesse)
                    for (const dateKey in state.events) {
                        state.events[dateKey] = state.events[dateKey].filter(order => order.clientId !== clientId);
                        if (state.events[dateKey].length === 0) {
                            delete state.events[dateKey];
                        }
                    }

                    saveData();
                    renderClients();
                    renderCalendar(); // Pour mettre à jour les marqueurs
                    alert("Client et commandes associées supprimés.");
                }
            }
        }


        // ########## LOGIQUE CALENDRIER ET COMMANDES ########################

        function populateClientSelect() {
            const select = document.getElementById('order-client');
            select.innerHTML = '<option value="">-- Sélectionnez un Client --</option>'; // Réinitialiser

            const sortedClients = [...state.clients].sort((a, b) => a.name.localeCompare(b.name));
            
            sortedClients.forEach(client => {
                const option = document.createElement('option');
                option.value = client.id;
                option.textContent = client.name;
                select.appendChild(option);
            });
        }

        function changeMonth(step) {
            currentMonth += step;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            } else if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            renderCalendar();
            // Nettoyer l'affichage
            document.getElementById('event-list').innerHTML = ''; 
            document.getElementById('event-date-title').textContent = 'Sélectionnez un jour';
            document.getElementById('event-list-message').textContent = 'Aucune commande planifiée pour cette date.';
            selectedDate = null;
        }

        function renderCalendar() {
            document.getElementById('month-year-display').textContent = `${monthNames[currentMonth]} ${currentYear}`;
            const calendarGrid = document.getElementById('calendar-grid');
            
            const dayNamesCount = 7;
            while (calendarGrid.children.length > dayNamesCount) {
                calendarGrid.removeChild(calendarGrid.lastChild);
            }

            const firstDayOfMonth = new Date(currentYear, currentMonth, 1);
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            let startDay = firstDayOfMonth.getDay();
            if (startDay === 0) startDay = 7; 
            let emptyDays = startDay - 1; 

            for (let i = 0; i < emptyDays; i++) {
                const emptyDiv = document.createElement('div');
                emptyDiv.className = 'calendar-day empty-day';
                calendarGrid.appendChild(emptyDiv);
            }

            for (let day = 1; day <= daysInMonth; day++) {
                const dateKey = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const dayDiv = document.createElement('div');
                dayDiv.className = 'calendar-day current-month';
                dayDiv.textContent = day;
                dayDiv.dataset.date = dateKey;
                dayDiv.onclick = (e) => {
                    document.querySelectorAll('.calendar-day').forEach(d => d.classList.remove('selected-day'));
                    e.currentTarget.classList.add('selected-day');
                    selectDate(dateKey);
                };

                if (day === NOW.getDate() && currentMonth === NOW.getMonth() && currentYear === NOW.getFullYear()) {
                    dayDiv.classList.add('today');
                }
                
                if (state.events[dateKey] && state.events[dateKey].length > 0) {
                    dayDiv.classList.add('has-event');
                }

                calendarGrid.appendChild(dayDiv);
            }
        }

        function selectDate(dateKey) {
            selectedDate = dateKey;
            renderOrders(dateKey);
        }

        // Rendu des commandes (anciennement renderEvents)
        function renderOrders(dateKey) {
            const orders = state.events[dateKey] || [];
            const list = document.getElementById('event-list');
            const message = document.getElementById('event-list-message');
            
            document.getElementById('event-date-title').textContent = `Commandes pour le ${new Date(dateKey).toLocaleDateString('fr-FR', { day: 'numeric', month: 'long' })}`;
            list.innerHTML = '';
            
            if (orders.length === 0) {
                message.style.display = 'block';
            } else {
                message.style.display = 'none';
                orders.forEach((order, index) => {
                    // Trouver le nom du client
                    const client = state.clients.find(c => c.id == order.clientId);
                    const clientName = client ? client.name : 'Client Supprimé/Inconnu';

                    const li = document.createElement('li');
                    li.innerHTML = `
                        <div class="details">
                            <strong>Client : ${clientName}</strong>
                            <p>Article : ${order.item} (${order.packs} Packs)</p>
                            <p>Montant : <span style="color: #4CAF50; font-weight: bold;">${order.amount.toFixed(2).replace('.', ',')} €</span></p>
                        </div>
                        <button class="delete-btn" onclick="deleteOrder('${dateKey}', ${index})">&times;</button>
                    `;
                    list.appendChild(li);
                });
            }
        }

        // Ajout d'une commande (anciennement addEvent)
        function addOrder() {
            if (!selectedDate) {
                alert("Veuillez d'abord sélectionner une date dans le calendrier.");
                return;
            }
            
            const clientId = document.getElementById('order-client').value;
            const amount = parseFloat(document.getElementById('order-amount').value) || 0;
            const packs = parseInt(document.getElementById('order-packs').value) || 0;
            const item = document.getElementById('order-item-description').value.trim();

            if (!clientId) {
                alert("Veuillez sélectionner un client.");
                return;
            }
            if (amount <= 0 || packs <= 0 || !item) {
                alert("Veuillez remplir correctement les champs Montant, Packs et Article (doivent être positifs).");
                return;
            }

            const newOrder = {
                clientId: parseInt(clientId),
                amount: amount,
                packs: packs,
                item: item,
                timestamp: new Date().toISOString()
            };

            if (!state.events[selectedDate]) {
                state.events[selectedDate] = [];
            }
            state.events[selectedDate].push(newOrder);
            
            saveData();
            
            // Mettre à jour l'affichage
            renderOrders(selectedDate);
            renderCalendar(); // Pour actualiser le point rouge
            
            // Réinitialiser le formulaire
            document.getElementById('order-client').value = '';
            document.getElementById('order-amount').value = '0.00';
            document.getElementById('order-packs').value = '0';
            document.getElementById('order-item-description').value = '';

            alert(`Commande planifiée pour le ${selectedDate} !`);
        }

        // Suppression d'une commande (anciennement deleteEvent)
        function deleteOrder(dateKey, index) {
            if (confirm("Êtes-vous sûr de vouloir supprimer cette commande planifiée ?")) {
                state.events[dateKey].splice(index, 1);
                
                // Si plus d'événements pour ce jour, supprimer la clé
                if (state.events[dateKey].length === 0) {
                    delete state.events[dateKey];
                }

                saveData();
                renderOrders(dateKey);
                renderCalendar(); // Pour enlever le point rouge si nécessaire
            }
        }
    </script>
</body>
</html>                <div class="calendar-header">
                    <button id="prev-month-button" onclick="changeMonth(-1)">&#9664;</button>
                    <span id="month-year-display"></span>
                    <button id="next-month-button" onclick="changeMonth(1)">&#9654;</button>
                </div>

                <div class="calendar-grid" id="calendar-grid">
                    <div class="day-name">Lun</div><div class="day-name">Mar</div><div class="day-name">Mer</div>
                    <div class="day-name">Jeu</div><div class="day-name">Ven</div><div class="day-name">Sam</div>
                    <div class="day-name">Dim</div>
                    </div>

                <div id="event-display">
                    <h3 id="event-date-title">Sélectionnez un jour</h3>
                    <p id="event-list-message" style="color:#FFD700; font-size:0.9em;">Aucune commande planifiée pour cette date.</p>
                    <ul id="event-list"></ul>
                    
                    <input type="text" id="event-input" placeholder="Ex: Commande 5 packs de Pierre" maxlength="50">
                    <button id="add-event-button" onclick="addEvent()">Ajouter la Commande</button>
                </div>

            </div>
            
            <div class="main-content">
                
                <h1>Espace de Travail - Gestion RBL LUXUURD</h1>
                <p id="current-datetime" style="color: #FFD700; font-weight: bold;"></p>

                <div class="widget-grid">
                    <div class="indicator-card" style="border-left: 5px solid #80CBC4;">
                        <h3>Revenus Totaux (€)</h3>
                        <p id="display-revenue">0.00</p>
                    </div>
                    <div class="indicator-card" style="border-left: 5px solid #FFCDD2;">
                        <h3>Dépenses Totales (€)</h3>
                        <p id="display-expense">0.00</p>
                    </div>
                    <div class="indicator-card" style="border-left: 5px solid #BBDEFB;">
                        <h3>Stock Actuel (Packs)</h3>
                        <p id="display-stock">0</p>
                    </div>
                </div>

                <div class="input-panel">
                    <h2>Enregistrement des Transactions</h2>
                    <div class="input-grid">
                        <div class="input-group">
                            <label for="input-revenue">Nouveau Revenu (€)</label>
                            <input type="number" id="input-revenue" placeholder="0.00" value="0.00">
                        </div>
                        <div class="input-group">
                            <label for="input-expense">Nouvelle Dépense (€)</label>
                            <input type="number" id="input-expense" placeholder="0.00" value="0.00">
                        </div>
                        <div class="input-group">
                            <label for="input-stock-in">Stock Reçu (+ Packs)</label>
                            <input type="number" id="input-stock-in" placeholder="0" value="0">
                        </div>
                        <div class="input-group">
                            <label for="input-stock-out">Stock Vendu (- Packs)</label>
                            <input type="number" id="input-stock-out" placeholder="0" value="0">
                        </div>
                    </div>
                    <button id="save-button" onclick="saveTransaction()">Ajouter Transaction & Mettre à jour les Totaux</button>
                    <p style="font-size: 0.8em; margin-top: 15px; color: #AAAAAA;">*Les totaux et les commandes du calendrier sont stockés dans le navigateur de cet appareil. Si vous effacez le cache, les données seront perdues.</p>
                </div>

            </div>
        </div>
    </div>

    <script>
        // ####################################################################
        // ########## PARAMÈTRES & SÉCURITÉ ###################################
        // ####################################################################
        const CORRECT_MONTHLY_CODE = "OCT2025"; 
        const NOW = new Date();
        let currentMonth = NOW.getMonth();
        let currentYear = NOW.getFullYear();
        let selectedDate = null;
        
        // Initialisation de l'état global
        let state = {
            revenue: 0,
            expense: 0,
            stock: 0,
            events: {} // Structure: {'YYYY-MM-DD': ['Event 1', 'Event 2']}
        };

        function checkCode() {
            const enteredCode = document.getElementById('dashboard-code-input').value.toUpperCase().trim();
            const resultElement = document.getElementById('security-result');

            if (enteredCode === CORRECT_MONTHLY_CODE) {
                document.getElementById('security-check').style.display = 'none';
                document.getElementById('content-area').style.display = 'block';
                localStorage.setItem('access_key_rbl', CORRECT_MONTHLY_CODE);
                loadData();
            } else {
                resultElement.textContent = "Code Invalide ou Expiré. ❌";
                resultElement.style.color = '#FF0000';
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            const savedKey = localStorage.getItem('access_key_rbl');
            if (savedKey === CORRECT_MONTHLY_CODE) {
                document.getElementById('security-check').style.display = 'none';
                document.getElementById('content-area').style.display = 'block';
                loadData();
            }
            document.getElementById('monthly-code').textContent = CORRECT_MONTHLY_CODE;
            updateDateTime();
            setInterval(updateDateTime, 1000); 
            renderCalendar();
        });
        
        function updateDateTime() {
            const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit' };
            const now = new Date();
            document.getElementById('current-datetime').textContent = `Date du jour : ${now.toLocaleDateString('fr-FR', dateOptions)} - ${now.toLocaleTimeString('fr-FR', timeOptions)}`;
        }

        // ####################################################################
        // ########## GESTION DES DONNÉES FINANCES/STOCK ######################
        // ####################################################################

        function loadData() {
            // Charge les totaux
            state.revenue = parseFloat(localStorage.getItem('rbl_total_revenue') || '0');
            state.expense = parseFloat(localStorage.getItem('rbl_total_expense') || '0');
            state.stock = parseInt(localStorage.getItem('rbl_current_stock') || '0');

            // Charge les événements du calendrier
            try {
                const storedEvents = localStorage.getItem('rbl_calendar_events');
                if (storedEvents) {
                    state.events = JSON.parse(storedEvents);
                }
            } catch (e) {
                console.error("Erreur lors du chargement des événements :", e);
                state.events = {};
            }
            
            updateDisplay();
            renderCalendar(); // Met à jour le calendrier après le chargement des événements
        }

        function updateDisplay() {
            document.getElementById('display-revenue').textContent = state.revenue.toFixed(2).replace('.', ',');
            document.getElementById('display-expense').textContent = state.expense.toFixed(2).replace('.', ',');
            document.getElementById('display-stock').textContent = state.stock;
        }

        function saveTransaction() {
            const revenueInput = parseFloat(document.getElementById('input-revenue').value) || 0;
            const expenseInput = parseFloat(document.getElementById('input-expense').value) || 0;
            const stockInInput = parseInt(document.getElementById('input-stock-in').value) || 0;
            const stockOutInput = parseInt(document.getElementById('input-stock-out').value) || 0;

            // Mettre à jour l'état
            state.revenue += revenueInput;
            state.expense += expenseInput;
            state.stock = state.stock + stockInInput - stockOutInput;
            
            // Sauvegarder dans le navigateur
            localStorage.setItem('rbl_total_revenue', state.revenue);
            localStorage.setItem('rbl_total_expense', state.expense);
            localStorage.setItem('rbl_current_stock', state.stock);

            // Réinitialiser les champs de saisie
            document.getElementById('input-revenue').value = '0.00';
            document.getElementById('input-expense').value = '0.00';
            document.getElementById('input-stock-in').value = '0';
            document.getElementById('input-stock-out').value = '0';
            
            updateDisplay();
            alert('Transaction sauvegardée localement !');
        }

        // ####################################################################
        // ########## LOGIQUE CALENDRIER ET ÉVÉNEMENTS ########################
        // ####################################################################

        const monthNames = ["Janvier", "Février", "Mars", "Avril", "Mai", "Juin", "Juillet", "Août", "Septembre", "Octobre", "Novembre", "Décembre"];

        function changeMonth(step) {
            currentMonth += step;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            } else if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            renderCalendar();
            document.getElementById('event-list').innerHTML = ''; // Nettoyer l'affichage de l'événement
            document.getElementById('event-date-title').textContent = 'Sélectionnez un jour';
            document.getElementById('event-list-message').style.display = 'block';
        }

        function renderCalendar() {
            document.getElementById('month-year-display').textContent = `${monthNames[currentMonth]} ${currentYear}`;
            const calendarGrid = document.getElementById('calendar-grid');
            
            // Nettoyer les jours (mais garder les noms des jours)
            const dayNamesCount = 7;
            while (calendarGrid.children.length > dayNamesCount) {
                calendarGrid.removeChild(calendarGrid.lastChild);
            }

            const firstDayOfMonth = new Date(currentYear, currentMonth, 1);
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            // getDay() renvoie 0 pour Dimanche, on veut 0 pour Lundi (Lundi=1, Dimanche=7)
            let startDay = firstDayOfMonth.getDay();
            if (startDay === 0) startDay = 7; // Convertir Dimanche (0) en 7
            let emptyDays = startDay - 1; // Nombre de jours vides avant le premier du mois

            // Jours vides
            for (let i = 0; i < emptyDays; i++) {
                const emptyDiv = document.createElement('div');
                emptyDiv.className = 'calendar-day empty-day';
                calendarGrid.appendChild(emptyDiv);
            }

            // Jours du mois
            for (let day = 1; day <= daysInMonth; day++) {
                const dateKey = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const dayDiv = document.createElement('div');
                dayDiv.className = 'calendar-day current-month';
                dayDiv.textContent = day;
                dayDiv.dataset.date = dateKey;
                dayDiv.onclick = () => selectDate(dayDiv, dateKey);

                // Marquer le jour actuel
                if (day === NOW.getDate() && currentMonth === NOW.getMonth() && currentYear === NOW.getFullYear()) {
                    dayDiv.classList.add('today');
                }
                
                // Marquer les jours avec des événements
                if (state.events[dateKey] && state.events[dateKey].length > 0) {
                    dayDiv.classList.add('has-event');
                }

                calendarGrid.appendChild(dayDiv);
            }
        }

        function selectDate(element, dateKey) {
            // Supprimer la sélection précédente
            document.querySelectorAll('.calendar-day').forEach(d => {
                d.style.backgroundColor = '';
            });

            // Ajouter la sélection actuelle
            element.style.backgroundColor = '#33334F';
            selectedDate = dateKey;
            
            renderEvents(dateKey);
        }

        function renderEvents(dateKey) {
            const events = state.events[dateKey] || [];
            const list = document.getElementById('event-list');
            const message = document.getElementById('event-list-message');
            document.getElementById('event-date-title').textContent = `Commandes pour le ${new Date(dateKey).toLocaleDateString('fr-FR', { day: 'numeric', month: 'long' })}`;
            list.innerHTML = '';
            
            if (events.length === 0) {
                message.style.display = 'block';
            } else {
                message.style.display = 'none';
                events.forEach((event, index) => {
                    const li = document.createElement('li');
                    li.textContent = event;
                    list.appendChild(li);
                });
            }
        }

        function addEvent() {
            if (!selectedDate) {
                alert("Veuillez d'abord sélectionner une date dans le calendrier.");
                return;
            }
            
            const input = document.getElementById('event-input');
            const eventText = input.value.trim();

            if (eventText) {
                if (!state.events[selectedDate]) {
                    state.events[selectedDate] = [];
                }
                state.events[selectedDate].push(eventText);
                
                // Sauvegarder dans localStorage
                localStorage.setItem('rbl_calendar_events', JSON.stringify(state.events));
                
                // Mettre à jour l'affichage
                renderEvents(selectedDate);
                renderCalendar(); // Pour ajouter le style 'has-event' au jour
                input.value = '';
                alert(`Commande planifiée pour le ${selectedDate} !`);
            }
        }
    </script>
</body>
</html>            cursor: pointer; 
            border-radius: 50%; 
            transition: background 0.2s;
            position: relative;
        }
        .calendar-day:not(.empty-day):hover { background: #33334F; }
        .today { border: 2px solid #4CAF50; background: #223322 !important; color: #4CAF50; }
        .has-event { border: 2px solid #FF0000; }
        .current-month { color: #EAEAEA; }
        .other-month { color: #555555; }
        
        /* Event Display Panel */
        #event-display { margin-top: 25px; padding: 15px; background: #0A0A10; border-radius: 5px; min-height: 100px; }
        #event-display h3 { color: #FF0000; margin-top: 0; }
        #event-input { width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #333; background: #1C1C2C; color: white; margin-top: 10px; box-sizing: border-box;}
        #add-event-button { background: #FFD700; color: #121212; padding: 8px; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; margin-top: 10px; width: 100%; }
        #event-list { list-style: none; padding: 0; text-align: left; }
        #event-list li { margin-bottom: 5px; border-left: 3px solid #FF0000; padding-left: 10px; }

        /* ------------------------------------------------------------------ */
        /* SECURITY OVERLAY */
        /* ------------------------------------------------------------------ */
        #content-area { display: none; height: 100%; }
        #security-check { 
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); 
            max-width: 450px; padding: 40px; background: #1C1C2C; border-radius: 15px; 
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6); border: 1px solid #33334F; 
            text-align: center; color: #E0E0E0; z-index: 999; 
        }
    </style>
</head>
<body>
    <div id="security-check">
        <h1>🔐 Accès Sécurisé au Tableau de Bord</h1>
        <p>Accès refusé. Veuillez entrer le code mensuel pour déverrouiller cet outil de travail privé.</p>
        <input type="text" id="dashboard-code-input" placeholder="Code Mensuel (Ex: OCT2025)">
        <button onclick="checkCode()">Déverrouiller</button>
        <div id="security-result"></div>
    </div>
    
    <div id="content-area">
        <div class="dashboard-wrapper">
            
            <div class="sidebar">
                <p style="font-size: 0.9em; color: #AAAAAA; margin-bottom: 25px;">Code du mois : <span id="monthly-code" style="color: #4CAF50;"></span></p>

                <h2>🗓️ Calendrier des Commandes Planifiées</h2>
                
                <div class="calendar-header">
                    <button id="prev-month-button" onclick="changeMonth(-1)">&#9664;</button>
                    <span id="month-year-display"></span>
                    <button id="next-month-button" onclick="changeMonth(1)">&#9654;</button>
                </div>

                <div class="calendar-grid" id="calendar-grid">
                    <div class="day-name">Lun</div><div class="day-name">Mar</div><div class="day-name">Mer</div>
                    <div class="day-name">Jeu</div><div class="day-name">Ven</div><div class="day-name">Sam</div>
                    <div class="day-name">Dim</div>
                    </div>

                <div id="event-display">
                    <h3 id="event-date-title">Sélectionnez un jour</h3>
                    <p id="event-list-message" style="color:#FFD700; font-size:0.9em;">Aucune commande planifiée pour cette date.</p>
                    <ul id="event-list"></ul>
                    
                    <input type="text" id="event-input" placeholder="Ex: Commande 5 packs de Pierre" maxlength="50">
                    <button id="add-event-button" onclick="addEvent()">Ajouter la Commande</button>
                </div>

            </div>
            
            <div class="main-content">
                
                <h1>Espace de Travail - Gestion RBL LUXUURD</h1>
                <p id="current-datetime" style="color: #FFD700; font-weight: bold;"></p>

                <div class="widget-grid">
                    <div class="indicator-card" style="border-left: 5px solid #80CBC4;">
                        <h3>Revenus Totaux (€)</h3>
                        <p id="display-revenue">0.00</p>
                    </div>
                    <div class="indicator-card" style="border-left: 5px solid #FFCDD2;">
                        <h3>Dépenses Totales (€)</h3>
                        <p id="display-expense">0.00</p>
                    </div>
                    <div class="indicator-card" style="border-left: 5px solid #BBDEFB;">
                        <h3>Stock Actuel (Packs)</h3>
                        <p id="display-stock">0</p>
                    </div>
                </div>

                <div class="input-panel">
                    <h2>Enregistrement des Transactions</h2>
                    <div class="input-grid">
                        <div class="input-group">
                            <label for="input-revenue">Nouveau Revenu (€)</label>
                            <input type="number" id="input-revenue" placeholder="0.00" value="0.00">
                        </div>
                        <div class="input-group">
                            <label for="input-expense">Nouvelle Dépense (€)</label>
                            <input type="number" id="input-expense" placeholder="0.00" value="0.00">
                        </div>
                        <div class="input-group">
                            <label for="input-stock-in">Stock Reçu (+ Packs)</label>
                            <input type="number" id="input-stock-in" placeholder="0" value="0">
                        </div>
                        <div class="input-group">
                            <label for="input-stock-out">Stock Vendu (- Packs)</label>
                            <input type="number" id="input-stock-out" placeholder="0" value="0">
                        </div>
                    </div>
                    <button id="save-button" onclick="saveTransaction()">Ajouter Transaction & Mettre à jour les Totaux</button>
                    <p style="font-size: 0.8em; margin-top: 15px; color: #AAAAAA;">*Les totaux et les commandes du calendrier sont stockés dans le navigateur de cet appareil. Si vous effacez le cache, les données seront perdues.</p>
                </div>

            </div>
        </div>
    </div>

    <script>
        // ####################################################################
        // ########## PARAMÈTRES & SÉCURITÉ ###################################
        // ####################################################################
        const CORRECT_MONTHLY_CODE = "OCT2025"; 
        const NOW = new Date();
        let currentMonth = NOW.getMonth();
        let currentYear = NOW.getFullYear();
        let selectedDate = null;
        
        // Initialisation de l'état global
        let state = {
            revenue: 0,
            expense: 0,
            stock: 0,
            events: {} // Structure: {'YYYY-MM-DD': ['Event 1', 'Event 2']}
        };

        function checkCode() {
            const enteredCode = document.getElementById('dashboard-code-input').value.toUpperCase().trim();
            const resultElement = document.getElementById('security-result');

            if (enteredCode === CORRECT_MONTHLY_CODE) {
                document.getElementById('security-check').style.display = 'none';
                document.getElementById('content-area').style.display = 'block';
                localStorage.setItem('access_key_rbl', CORRECT_MONTHLY_CODE);
                loadData();
            } else {
                resultElement.textContent = "Code Invalide ou Expiré. ❌";
                resultElement.style.color = '#FF0000';
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            const savedKey = localStorage.getItem('access_key_rbl');
            if (savedKey === CORRECT_MONTHLY_CODE) {
                document.getElementById('security-check').style.display = 'none';
                document.getElementById('content-area').style.display = 'block';
                loadData();
            }
            document.getElementById('monthly-code').textContent = CORRECT_MONTHLY_CODE;
            updateDateTime();
            setInterval(updateDateTime, 1000); 
            renderCalendar();
        });
        
        function updateDateTime() {
            const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit' };
            const now = new Date();
            document.getElementById('current-datetime').textContent = `Date du jour : ${now.toLocaleDateString('fr-FR', dateOptions)} - ${now.toLocaleTimeString('fr-FR', timeOptions)}`;
        }


        // ####################################################################
        // ########## GESTION DES DONNÉES FINANCES/STOCK ######################
        // ####################################################################

        function loadData() {
            // Charge les totaux
            state.revenue = parseFloat(localStorage.getItem('rbl_total_revenue') || '0');
            state.expense = parseFloat(localStorage.getItem('rbl_total_expense') || '0');
            state.stock = parseInt(localStorage.getItem('rbl_current_stock') || '0');

            // Charge les événements du calendrier
            try {
                const storedEvents = localStorage.getItem('rbl_calendar_events');
                if (storedEvents) {
                    state.events = JSON.parse(storedEvents);
                }
            } catch (e) {
                console.error("Erreur lors du chargement des événements :", e);
                state.events = {};
            }
            
            updateDisplay();
            renderCalendar(); // Met à jour le calendrier après le chargement des événements
        }

        function updateDisplay() {
            document.getElementById('display-revenue').textContent = state.revenue.toFixed(2).replace('.', ',');
            document.getElementById('display-expense').textContent = state.expense.toFixed(2).replace('.', ',');
            document.getElementById('display-stock').textContent = state.stock;
        }

        function saveTransaction() {
            const revenueInput = parseFloat(document.getElementById('input-revenue').value) || 0;
            const expenseInput = parseFloat(document.getElementById('input-expense').value) || 0;
            const stockInInput = parseInt(document.getElementById('input-stock-in').value) || 0;
            const stockOutInput = parseInt(document.getElementById('input-stock-out').value) || 0;

            // Mettre à jour l'état
            state.revenue += revenueInput;
            state.expense += expenseInput;
            state.stock = state.stock + stockInInput - stockOutInput;
            
            // Sauvegarder dans le navigateur
            localStorage.setItem('rbl_total_revenue', state.revenue);
            localStorage.setItem('rbl_total_expense', state.expense);
            localStorage.setItem('rbl_current_stock', state.stock);

            // Réinitialiser les champs de saisie
            document.getElementById('input-revenue').value = '0.00';
            document.getElementById('input-expense').value = '0.00';
            document.getElementById('input-stock-in').value = '0';
            document.getElementById('input-stock-out').value = '0';
            
            updateDisplay();
            alert('Transaction sauvegardée localement !');
        }

        // ####################################################################
        // ########## LOGIQUE CALENDRIER ET ÉVÉNEMENTS ########################
        // ####################################################################

        const monthNames = ["Janvier", "Février", "Mars", "Avril", "Mai", "Juin", "Juillet", "Août", "Septembre", "Octobre", "Novembre", "Décembre"];

        function changeMonth(step) {
            currentMonth += step;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            } else if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            renderCalendar();
            document.getElementById('event-list').innerHTML = ''; // Nettoyer l'affichage de l'événement
            document.getElementById('event-date-title').textContent = 'Sélectionnez un jour';
            document.getElementById('event-list-message').style.display = 'block';
        }

        function renderCalendar() {
            document.getElementById('month-year-display').textContent = `${monthNames[currentMonth]} ${currentYear}`;
            const calendarGrid = document.getElementById('calendar-grid');
            
            // Nettoyer les jours (mais garder les noms des jours)
            const dayNamesCount = 7;
            while (calendarGrid.children.length > dayNamesCount) {
                calendarGrid.removeChild(calendarGrid.lastChild);
            }

            const firstDayOfMonth = new Date(currentYear, currentMonth, 1);
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            // getDay() renvoie 0 pour Dimanche, on veut 0 pour Lundi (Lundi=1, Dimanche=7)
            let startDay = firstDayOfMonth.getDay();
            if (startDay === 0) startDay = 7; // Convertir Dimanche (0) en 7
            let emptyDays = startDay - 1; // Nombre de jours vides avant le premier du mois

            // Jours vides
            for (let i = 0; i < emptyDays; i++) {
                const emptyDiv = document.createElement('div');
                emptyDiv.className = 'calendar-day empty-day';
                calendarGrid.appendChild(emptyDiv);
            }

            // Jours du mois
            for (let day = 1; day <= daysInMonth; day++) {
                const dateKey = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const dayDiv = document.createElement('div');
                dayDiv.className = 'calendar-day current-month';
                dayDiv.textContent = day;
                dayDiv.dataset.date = dateKey;
                dayDiv.onclick = () => selectDate(dayDiv, dateKey);

                // Marquer le jour actuel
                if (day === NOW.getDate() && currentMonth === NOW.getMonth() && currentYear === NOW.getFullYear()) {
                    dayDiv.classList.add('today');
                }
                
                // Marquer les jours avec des événements
                if (state.events[dateKey] && state.events[dateKey].length > 0) {
                    dayDiv.classList.add('has-event');
                }

                calendarGrid.appendChild(dayDiv);
            }
        }

        function selectDate(element, dateKey) {
            // Supprimer la sélection précédente
            document.querySelectorAll('.calendar-day').forEach(d => {
                d.style.backgroundColor = '';
            });

            // Ajouter la sélection actuelle
            element.style.backgroundColor = '#33334F';
            selectedDate = dateKey;
            
            renderEvents(dateKey);
        }

        function renderEvents(dateKey) {
            const events = state.events[dateKey] || [];
            const list = document.getElementById('event-list');
            const message = document.getElementById('event-list-message');
            document.getElementById('event-date-title').textContent = `Commandes pour le ${new Date(dateKey).toLocaleDateString('fr-FR', { day: 'numeric', month: 'long' })}`;
            list.innerHTML = '';
            
            if (events.length === 0) {
                message.style.display = 'block';
            } else {
                message.style.display = 'none';
                events.forEach((event, index) => {
                    const li = document.createElement('li');
                    li.textContent = event;
                    list.appendChild(li);
                });
            }
        }

        function addEvent() {
            if (!selectedDate) {
                alert("Veuillez d'abord sélectionner une date dans le calendrier.");
                return;
            }
            
            const input = document.getElementById('event-input');
            const eventText = input.value.trim();

            if (eventText) {
                if (!state.events[selectedDate]) {
                    state.events[selectedDate] = [];
                }
                state.events[selectedDate].push(eventText);
                
                // Sauvegarder dans localStorage
                localStorage.setItem('rbl_calendar_events', JSON.stringify(state.events));
                
                // Mettre à jour l'affichage
                renderEvents(selectedDate);
                renderCalendar(); // Pour ajouter le style 'has-event' au jour
                input.value = '';
                alert(`Commande planifiée pour le ${selectedDate} !`);
            }
        }
    </script>
</body>
</html>        #event-input { width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #333; background: #1C1C2C; color: white; margin-top: 10px; box-sizing: border-box;}
        #add-event-button { background: #FFD700; color: #121212; padding: 8px; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; margin-top: 10px; width: 100%; }
        #event-list { list-style: none; padding: 0; text-align: left; }
        #event-list li { margin-bottom: 5px; border-left: 3px solid #FF0000; padding-left: 10px; }

        /* ------------------------------------------------------------------ */
        /* SECURITY OVERLAY */
        /* ------------------------------------------------------------------ */
        #content-area { display: none; height: 100%; }
        #security-check { 
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); 
            max-width: 450px; padding: 40px; background: #1C1C2C; border-radius: 15px; 
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6); border: 1px solid #33334F; 
            text-align: center; color: #E0E0E0; z-index: 999; 
        }
    </style>
</head>
<body>
    <div id="security-check">
        <h1>🔐 Accès Sécurisé au Tableau de Bord</h1>
        <p>Accès refusé. Veuillez entrer le code mensuel pour déverrouiller cet outil de travail privé.</p>
        <input type="text" id="dashboard-code-input" placeholder="Code Mensuel (Ex: OCT2025)">
        <button onclick="checkCode()">Déverrouiller</button>
        <div id="security-result"></div>
    </div>
    
    <div id="content-area">
        <div class="dashboard-wrapper">
            
            <div class="sidebar">
                <p style="font-size: 0.9em; color: #AAAAAA; margin-bottom: 25px;">Code du mois : <span id="monthly-code" style="color: #4CAF50;"></span></p>

                <h2>🗓️ Calendrier des Commandes Planifiées</h2>
                
                <div class="calendar-header">
                    <button id="prev-month-button" onclick="changeMonth(-1)">&#9664;</button>
                    <span id="month-year-display"></span>
                    <button id="next-month-button" onclick="changeMonth(1)">&#9654;</button>
                </div>

                <div class="calendar-grid" id="calendar-grid">
                    <div class="day-name">Lun</div><div class="day-name">Mar</div><div class="day-name">Mer</div>
                    <div class="day-name">Jeu</div><div class="day-name">Ven</div><div class="day-name">Sam</div>
                    <div class="day-name">Dim</div>
                    </div>

                <div id="event-display">
                    <h3 id="event-date-title">Sélectionnez un jour</h3>
                    <p id="event-list-message" style="color:#FFD700; font-size:0.9em;">Aucune commande planifiée pour cette date.</p>
                    <ul id="event-list"></ul>
                    
                    <input type="text" id="event-input" placeholder="Ex: Commande 5 packs de Pierre" maxlength="50">
                    <button id="add-event-button" onclick="addEvent()">Ajouter la Commande</button>
                </div>

            </div>
            
            <div class="main-content">
                
                <h1>Espace de Travail - Gestion RBL LUXUURD</h1>
                <p id="current-datetime" style="color: #FFD700; font-weight: bold;"></p>

                <div class="widget-grid">
                    <div class="indicator-card" style="border-left: 5px solid #80CBC4;">
                        <h3>Revenus Totaux (€)</h3>
                        <p id="display-revenue">0.00</p>
                    </div>
                    <div class="indicator-card" style="border-left: 5px solid #FFCDD2;">
                        <h3>Dépenses Totales (€)</h3>
                        <p id="display-expense">0.00</p>
                    </div>
                    <div class="indicator-card" style="border-left: 5px solid #BBDEFB;">
                        <h3>Stock Actuel (Packs)</h3>
                        <p id="display-stock">0</p>
                    </div>
                </div>

                <div class="input-panel">
                    <h2>Enregistrement des Transactions</h2>
                    <div class="input-grid">
                        <div class="input-group">
                            <label for="input-revenue">Nouveau Revenu (€)</label>
                            <input type="number" id="input-revenue" placeholder="0.00" value="0.00">
                        </div>
                        <div class="input-group">
                            <label for="input-expense">Nouvelle Dépense (€)</label>
                            <input type="number" id="input-expense" placeholder="0.00" value="0.00">
                        </div>
                        <div class="input-group">
                            <label for="input-stock-in">Stock Reçu (+ Packs)</label>
                            <input type="number" id="input-stock-in" placeholder="0" value="0">
                        </div>
                        <div class="input-group">
                            <label for="input-stock-out">Stock Vendu (- Packs)</label>
                            <input type="number" id="input-stock-out" placeholder="0" value="0">
                        </div>
                    </div>
                    <button id="save-button" onclick="saveTransaction()">Ajouter Transaction & Mettre à jour les Totaux</button>
                    <p style="font-size: 0.8em; margin-top: 15px; color: #AAAAAA;">*Les totaux et les commandes du calendrier sont stockés dans le navigateur de cet appareil. Si vous effacez le cache, les données seront perdues.</p>
                </div>

            </div>
        </div>
    </div>

    <script>
        // ####################################################################
        // ########## PARAMÈTRES & SÉCURITÉ ###################################
        // ####################################################################
        const CORRECT_MONTHLY_CODE = "OCT2025"; 
        const NOW = new Date();
        let currentMonth = NOW.getMonth();
        let currentYear = NOW.getFullYear();
        let selectedDate = null;
        
        // Initialisation de l'état global
        let state = {
            revenue: 0,
            expense: 0,
            stock: 0,
            events: {} // Structure: {'YYYY-MM-DD': ['Event 1', 'Event 2']}
        };

        function checkCode() {
            const enteredCode = document.getElementById('dashboard-code-input').value.toUpperCase().trim();
            const resultElement = document.getElementById('security-result');

            if (enteredCode === CORRECT_MONTHLY_CODE) {
                document.getElementById('security-check').style.display = 'none';
                document.getElementById('content-area').style.display = 'block';
                localStorage.setItem('access_key_rbl', CORRECT_MONTHLY_CODE);
                loadData();
            } else {
                resultElement.textContent = "Code Invalide ou Expiré. ❌";
                resultElement.style.color = '#FF0000';
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            const savedKey = localStorage.getItem('access_key_rbl');
            if (savedKey === CORRECT_MONTHLY_CODE) {
                document.getElementById('security-check').style.display = 'none';
                document.getElementById('content-area').style.display = 'block';
                loadData();
            }
            document.getElementById('monthly-code').textContent = CORRECT_MONTHLY_CODE;
            updateDateTime();
            setInterval(updateDateTime, 1000); 
            renderCalendar();
        });
        
        function updateDateTime() {
            const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit' };
            const now = new Date();
            document.getElementById('current-datetime').textContent = `Date du jour : ${now.toLocaleDateString('fr-FR', dateOptions)} - ${now.toLocaleTimeString('fr-FR', timeOptions)}`;
        }

        // ####################################################################
        // ########## GESTION DES DONNÉES FINANCES/STOCK ######################
        // ####################################################################

        function loadData() {
            // Charge les totaux
            state.revenue = parseFloat(localStorage.getItem('rbl_total_revenue') || '0');
            state.expense = parseFloat(localStorage.getItem('rbl_total_expense') || '0');
            state.stock = parseInt(localStorage.getItem('rbl_current_stock') || '0');

            // Charge les événements du calendrier
            try {
                const storedEvents = localStorage.getItem('rbl_calendar_events');
                if (storedEvents) {
                    state.events = JSON.parse(storedEvents);
                }
            } catch (e) {
                console.error("Erreur lors du chargement des événements :", e);
                state.events = {};
            }
            
            updateDisplay();
            renderCalendar(); // Met à jour le calendrier après le chargement des événements
        }

        function updateDisplay() {
            document.getElementById('display-revenue').textContent = state.revenue.toFixed(2).replace('.', ',');
            document.getElementById('display-expense').textContent = state.expense.toFixed(2).replace('.', ',');
            document.getElementById('display-stock').textContent = state.stock;
        }

        function saveTransaction() {
            const revenueInput = parseFloat(document.getElementById('input-revenue').value) || 0;
            const expenseInput = parseFloat(document.getElementById('input-expense').value) || 0;
            const stockInInput = parseInt(document.getElementById('input-stock-in').value) || 0;
            const stockOutInput = parseInt(document.getElementById('input-stock-out').value) || 0;

            // Mettre à jour l'état
            state.revenue += revenueInput;
            state.expense += expenseInput;
            state.stock = state.stock + stockInInput - stockOutInput;
            
            // Sauvegarder dans le navigateur
            localStorage.setItem('rbl_total_revenue', state.revenue);
            localStorage.setItem('rbl_total_expense', state.expense);
            localStorage.setItem('rbl_current_stock', state.stock);

            // Réinitialiser les champs de saisie
            document.getElementById('input-revenue').value = '0.00';
            document.getElementById('input-expense').value = '0.00';
            document.getElementById('input-stock-in').value = '0';
            document.getElementById('input-stock-out').value = '0';
            
            updateDisplay();
            alert('Transaction sauvegardée localement !');
        }

        // ####################################################################
        // ########## LOGIQUE CALENDRIER ET ÉVÉNEMENTS ########################
        // ####################################################################

        const monthNames = ["Janvier", "Février", "Mars", "Avril", "Mai", "Juin", "Juillet", "Août", "Septembre", "Octobre", "Novembre", "Décembre"];

        function changeMonth(step) {
            currentMonth += step;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            } else if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            renderCalendar();
            document.getElementById('event-list').innerHTML = ''; // Nettoyer l'affichage de l'événement
            document.getElementById('event-date-title').textContent = 'Sélectionnez un jour';
            document.getElementById('event-list-message').style.display = 'block';
        }

        function renderCalendar() {
            document.getElementById('month-year-display').textContent = `${monthNames[currentMonth]} ${currentYear}`;
            const calendarGrid = document.getElementById('calendar-grid');
            
            // Nettoyer les jours (mais garder les noms des jours)
            const dayNamesCount = 7;
            while (calendarGrid.children.length > dayNamesCount) {
                calendarGrid.removeChild(calendarGrid.lastChild);
            }

            const firstDayOfMonth = new Date(currentYear, currentMonth, 1);
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            // getDay() renvoie 0 pour Dimanche, on veut 0 pour Lundi (Lundi=1, Dimanche=7)
            let startDay = firstDayOfMonth.getDay();
            if (startDay === 0) startDay = 7; // Convertir Dimanche (0) en 7
            let emptyDays = startDay - 1; // Nombre de jours vides avant le premier du mois

            // Jours vides
            for (let i = 0; i < emptyDays; i++) {
                const emptyDiv = document.createElement('div');
                emptyDiv.className = 'calendar-day empty-day';
                calendarGrid.appendChild(emptyDiv);
            }

            // Jours du mois
            for (let day = 1; day <= daysInMonth; day++) {
                const dateKey = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const dayDiv = document.createElement('div');
                dayDiv.className = 'calendar-day current-month';
                dayDiv.textContent = day;
                dayDiv.dataset.date = dateKey;
                dayDiv.onclick = () => selectDate(dayDiv, dateKey);

                // Marquer le jour actuel
                if (day === NOW.getDate() && currentMonth === NOW.getMonth() && currentYear === NOW.getFullYear()) {
                    dayDiv.classList.add('today');
                }
                
                // Marquer les jours avec des événements
                if (state.events[dateKey] && state.events[dateKey].length > 0) {
                    dayDiv.classList.add('has-event');
                }

                calendarGrid.appendChild(dayDiv);
            }
        }

        function selectDate(element, dateKey) {
            // Supprimer la sélection précédente
            document.querySelectorAll('.calendar-day').forEach(d => {
                d.style.backgroundColor = '';
            });

            // Ajouter la sélection actuelle
            element.style.backgroundColor = '#33334F';
            selectedDate = dateKey;
            
            renderEvents(dateKey);
        }

        function renderEvents(dateKey) {
            const events = state.events[dateKey] || [];
            const list = document.getElementById('event-list');
            const message = document.getElementById('event-list-message');
            document.getElementById('event-date-title').textContent = `Commandes pour le ${new Date(dateKey).toLocaleDateString('fr-FR', { day: 'numeric', month: 'long' })}`;
            list.innerHTML = '';
            
            if (events.length === 0) {
                message.style.display = 'block';
            } else {
                message.style.display = 'none';
                events.forEach((event, index) => {
                    const li = document.createElement('li');
                    li.textContent = event;
                    list.appendChild(li);
                });
            }
        }

        function addEvent() {
            if (!selectedDate) {
                alert("Veuillez d'abord sélectionner une date dans le calendrier.");
                return;
            }
            
            const input = document.getElementById('event-input');
            const eventText = input.value.trim();

            if (eventText) {
                if (!state.events[selectedDate]) {
                    state.events[selectedDate] = [];
                }
                state.events[selectedDate].push(eventText);
                
                // Sauvegarder dans localStorage
                localStorage.setItem('rbl_calendar_events', JSON.stringify(state.events));
                
                // Mettre à jour l'affichage
                renderEvents(selectedDate);
                renderCalendar(); // Pour ajouter le style 'has-event' au jour
                input.value = '';
                alert(`Commande planifiée pour le ${selectedDate} !`);
            }
        }
    </script>
</body>
</html>


        /* ------------------------------------------------------------------ */
        /* INPUT PANEL */
        /* ------------------------------------------------------------------ */
        .input-panel { background: #151520; padding: 30px; border-radius: 10px; margin-bottom: 30px; }
        .input-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .input-group { margin-bottom: 15px; }
        .input-group label { display: block; font-size: 0.9em; margin-bottom: 5px; color: #FFD700; }
        .input-group input { width: 100%; padding: 12px; border-radius: 5px; border: 1px solid #333; background: #0A0A10; color: white; font-size: 1em; box-sizing: border-box; }
        #save-button { background: #FF0000; color: white; padding: 15px; border: none; border-radius: 5px; font-size: 1.1em; font-weight: bold; cursor: pointer; width: 100%; margin-top: 10px; transition: background 0.3s; }
        #save-button:hover { background: #cc0000; }

        /* ------------------------------------------------------------------ */
        /* CALENDAR STYLES */
        /* ------------------------------------------------------------------ */
        .calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .calendar-header button { background: none; border: none; color: #FFD700; font-size: 1.5em; cursor: pointer; }
        #month-year-display { font-size: 1.2em; font-weight: bold; }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); text-align: center; }
        .day-name { font-size: 0.8em; color: #AAAAAA; padding: 5px 0; }
        .calendar-day { 
            padding: 8px 0; 
            cursor: pointer; 
            border-radius: 50%; 
            transition: background 0.2s;
            position: relative;
        }
        .calendar-day:not(.empty-day):hover { background: #33334F; }
        .today { border: 2px solid #4CAF50; background: #223322 !important; color: #4CAF50; }
        .has-event { border: 2px solid #FF0000; }
        .current-month { color: #EAEAEA; }
        .other-month { color: #555555; }
        
        /* Event Display Panel */
        #event-display { margin-top: 25px; padding: 15px; background: #0A0A10; border-radius: 5px; min-height: 100px; }
        #event-display h3 { color: #FF0000; margin-top: 0; }
        #event-input { width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #333; background: #1C1C2C; color: white; margin-top: 10px; box-sizing: border-box;}
        #add-event-button { background: #FFD700; color: #121212; padding: 8px; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; margin-top: 10px; width: 100%; }
        #event-list { list-style: none; padding: 0; text-align: left; }
        #event-list li { margin-bottom: 5px; border-left: 3px solid #FF0000; padding-left: 10px; }

        /* ------------------------------------------------------------------ */
        /* SECURITY OVERLAY */
        /* ------------------------------------------------------------------ */
        #content-area { display: none; height: 100%; }
        #security-check { 
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); 
            max-width: 450px; padding: 40px; background: #1C1C2C; border-radius: 15px; 
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6); border: 1px solid #33334F; 
            text-align: center; color: #E0E0E0; z-index: 999; 
        }
    </style>
</head>
<body>
    <div id="security-check">
        <h1>🔐 Accès Sécurisé au Tableau de Bord</h1>
        <p>Accès refusé. Veuillez entrer le code mensuel pour déverrouiller cet outil de travail privé.</p>
        <input type="text" id="dashboard-code-input" placeholder="Code Mensuel (Ex: OCT2025)">
        <button onclick="checkCode()">Déverrouiller</button>
        <div id="security-result"></div>
    </div>
    
    <div id="content-area">
        <div class="dashboard-wrapper">
            
            <div class="sidebar">
                <p style="font-size: 0.9em; color: #AAAAAA; margin-bottom: 25px;">Code du mois : <span id="monthly-code" style="color: #4CAF50;"></span></p>

                <h2>🗓️ Calendrier des Commandes Planifiées</h2>
                
                <div class="calendar-header">
                    <button id="prev-month-button" onclick="changeMonth(-1)">&#9664;</button>
                    <span id="month-year-display"></span>
                    <button id="next-month-button" onclick="changeMonth(1)">&#9654;</button>
                </div>

                <div class="calendar-grid" id="calendar-grid">
                    <div class="day-name">Lun</div><div class="day-name">Mar</div><div class="day-name">Mer</div>
                    <div class="day-name">Jeu</div><div class="day-name">Ven</div><div class="day-name">Sam</div>
                    <div class="day-name">Dim</div>
                    </div>

                <div id="event-display">
                    <h3 id="event-date-title">Sélectionnez un jour</h3>
                    <p id="event-list-message" style="color:#FFD700; font-size:0.9em;">Aucune commande planifiée pour cette date.</p>
                    <ul id="event-list"></ul>
                    
                    <input type="text" id="event-input" placeholder="Ex: Commande 5 packs de Pierre" maxlength="50">
                    <button id="add-event-button" onclick="addEvent()">Ajouter la Commande</button>
                </div>

            </div>
            
            <div class="main-content">
                
                <h1>Espace de Travail - Gestion RBL LUXUURD</h1>
                <p id="current-datetime" style="color: #FFD700; font-weight: bold;"></p>

                <div class="widget-grid">
                    <div class="indicator-card" style="border-left: 5px solid #80CBC4;">
                        <h3>Revenus Totaux (€)</h3>
                        <p id="display-revenue">0.00</p>
                    </div>
                    <div class="indicator-card" style="border-left: 5px solid #FFCDD2;">
                        <h3>Dépenses Totales (€)</h3>
                        <p id="display-expense">0.00</p>
                    </div>
                    <div class="indicator-card" style="border-left: 5px solid #BBDEFB;">
                        <h3>Stock Actuel (Packs)</h3>
                        <p id="display-stock">0</p>
                    </div>
                </div>

                <div class="input-panel">
                    <h2>Enregistrement des Transactions</h2>
                    <div class="input-grid">
                        <div class="input-group">
                            <label for="input-revenue">Nouveau Revenu (€)</label>
                            <input type="number" id="input-revenue" placeholder="0.00" value="0.00">
                        </div>
                        <div class="input-group">
                            <label for="input-expense">Nouvelle Dépense (€)</label>
                            <input type="number" id="input-expense" placeholder="0.00" value="0.00">
                        </div>
                        <div class="input-group">
                            <label for="input-stock-in">Stock Reçu (+ Packs)</label>
                            <input type="number" id="input-stock-in" placeholder="0" value="0">
                        </div>
                        <div class="input-group">
                            <label for="input-stock-out">Stock Vendu (- Packs)</label>
                            <input type="number" id="input-stock-out" placeholder="0" value="0">
                        </div>
                    </div>
                    <button id="save-button" onclick="saveTransaction()">Ajouter Transaction & Mettre à jour les Totaux</button>
                    <p style="font-size: 0.8em; margin-top: 15px; color: #AAAAAA;">*Les totaux et les commandes du calendrier sont stockés dans le navigateur de cet appareil. Si vous effacez le cache, les données seront perdues.</p>
                </div>

            </div>
        </div>
    </div>

    <script>
        // ####################################################################
        // ########## PARAMÈTRES & SÉCURITÉ ###################################
        // ####################################################################
        const CORRECT_MONTHLY_CODE = "OCT2025"; 
        const NOW = new Date();
        let currentMonth = NOW.getMonth();
        let currentYear = NOW.getFullYear();
        let selectedDate = null;
        
        // Initialisation de l'état global
        let state = {
            revenue: 0,
            expense: 0,
            stock: 0,
            events: {} // Structure: {'YYYY-MM-DD': ['Event 1', 'Event 2']}
        };

        function checkCode() {
            const enteredCode = document.getElementById('dashboard-code-input').value.toUpperCase().trim();
            const resultElement = document.getElementById('security-result');

            if (enteredCode === CORRECT_MONTHLY_CODE) {
                document.getElementById('security-check').style.display = 'none';
                document.getElementById('content-area').style.display = 'block';
                localStorage.setItem('access_key_rbl', CORRECT_MONTHLY_CODE);
                loadData();
            } else {
                resultElement.textContent = "Code Invalide ou Expiré. ❌";
                resultElement.style.color = '#FF0000';
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            // Vérification du code dans l'URL (si on vient du Portail)
            const urlParams = new URLSearchParams(window.location.search);
            const urlKey = urlParams.get('key');

            if (urlKey === CORRECT_MONTHLY_CODE) {
                document.getElementById('security-check').style.display = 'none';
                document.getElementById('content-area').style.display = 'block';
                localStorage.setItem('access_key_rbl', CORRECT_MONTHLY_CODE);
                loadData();
            } else {
                 // Vérification du code dans le LocalStorage (si on revient sur la page)
                const savedKey = localStorage.getItem('access_key_rbl');
                if (savedKey === CORRECT_MONTHLY_CODE) {
                    document.getElementById('security-check').style.display = 'none';
                    document.getElementById('content-area').style.display = 'block';
                    loadData();
                }
            }

            document.getElementById('monthly-code').textContent = CORRECT_MONTHLY_CODE;
            updateDateTime();
            setInterval(updateDateTime, 1000); 
            renderCalendar();
        });
        
        function updateDateTime() {
            const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit' };
            const now = new Date();
            document.getElementById('current-datetime').textContent = `Date du jour : ${now.toLocaleDateString('fr-FR', dateOptions)} - ${now.toLocaleTimeString('fr-FR', timeOptions)}`;
        }


        // ####################################################################
        // ########## GESTION DES DONNÉES FINANCES/STOCK ######################
        // ####################################################################

        function loadData() {
            // Charge les totaux
            state.revenue = parseFloat(localStorage.getItem('rbl_total_revenue') || '0');
            state.expense = parseFloat(localStorage.getItem('rbl_total_expense') || '0');
            state.stock = parseInt(localStorage.getItem('rbl_current_stock') || '0');

            // Charge les événements du calendrier
            try {
                const storedEvents = localStorage.getItem('rbl_calendar_events');
                if (storedEvents) {
                    state.events = JSON.parse(storedEvents);
                }
            } catch (e) {
                console.error("Erreur lors du chargement des événements :", e);
                state.events = {};
            }
            
            updateDisplay();
            renderCalendar(); // Met à jour le calendrier après le chargement des événements
        }

        function updateDisplay() {
            document.getElementById('display-revenue').textContent = state.revenue.toFixed(2).replace('.', ',');
            document.getElementById('display-expense').textContent = state.expense.toFixed(2).replace('.', ',');
            document.getElementById('display-stock').textContent = state.stock;
        }

        function saveTransaction() {
            const revenueInput = parseFloat(document.getElementById('input-revenue').value) || 0;
            const expenseInput = parseFloat(document.getElementById('input-expense').value) || 0;
            const stockInInput = parseInt(document.getElementById('input-stock-in').value) || 0;
            const stockOutInput = parseInt(document.getElementById('input-stock-out').value) || 0;

            // Mettre à jour l'état
            state.revenue += revenueInput;
            state.expense += expenseInput;
            state.stock = state.stock + stockInInput - stockOutInput;
            
            // Sauvegarder dans le navigateur
            localStorage.setItem('rbl_total_revenue', state.revenue);
            localStorage.setItem('rbl_total_expense', state.expense);
            localStorage.setItem('rbl_current_stock', state.stock);

            // Réinitialiser les champs de saisie
            document.getElementById('input-revenue').value = '0.00';
            document.getElementById('input-expense').value = '0.00';
            document.getElementById('input-stock-in').value = '0';
            document.getElementById('input-stock-out').value = '0';
            
            updateDisplay();
            alert('Transaction sauvegardée localement !');
        }

        // ####################################################################
        // ########## LOGIQUE CALENDRIER ET ÉVÉNEMENTS ########################
        // ####################################################################

        const monthNames = ["Janvier", "Février", "Mars", "Avril", "Mai", "Juin", "Juillet", "Août", "Septembre", "Octobre", "Novembre", "Décembre"];

        function changeMonth(step) {
            currentMonth += step;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            } else if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            renderCalendar();
            document.getElementById('event-list').innerHTML = ''; // Nettoyer l'affichage de l'événement
            document.getElementById('event-date-title').textContent = 'Sélectionnez un jour';
            document.getElementById('event-list-message').style.display = 'block';
            selectedDate = null;
        }

        function renderCalendar() {
            document.getElementById('month-year-display').textContent = `${monthNames[currentMonth]} ${currentYear}`;
            const calendarGrid = document.getElementById('calendar-grid');
            
            // Nettoyer les jours (mais garder les noms des jours)
            const dayNamesCount = 7;
            while (calendarGrid.children.length > dayNamesCount) {
                calendarGrid.removeChild(calendarGrid.lastChild);
            }

            const firstDayOfMonth = new Date(currentYear, currentMonth, 1);
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            // getDay() renvoie 0 pour Dimanche, on veut 0 pour Lundi (Lundi=1, Dimanche=7)
            let startDay = firstDayOfMonth.getDay();
            if (startDay === 0) startDay = 7; // Convertir Dimanche (0) en 7
            let emptyDays = startDay - 1; // Nombre de jours vides avant le premier du mois

            // Jours vides
            for (let i = 0; i < emptyDays; i++) {
                const emptyDiv = document.createElement('div');
                emptyDiv.className = 'calendar-day empty-day';
                calendarGrid.appendChild(emptyDiv);
            }

            // Jours du mois
            for (let day = 1; day <= daysInMonth; day++) {
                const dateKey = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const dayDiv = document.createElement('div');
                dayDiv.className = 'calendar-day current-month';
                dayDiv.textContent = day;
                dayDiv.dataset.date = dateKey;
                dayDiv.onclick = () => selectDate(dayDiv, dateKey);

                // Marquer le jour actuel
                if (day === NOW.getDate() && currentMonth === NOW.getMonth() && currentYear === NOW.getFullYear()) {
                    dayDiv.classList.add('today');
                }
                
                // Marquer les jours avec des événements
                if (state.events[dateKey] && state.events[dateKey].length > 0) {
                    dayDiv.classList.add('has-event');
                }

                calendarGrid.appendChild(dayDiv);
            }
        }

        function selectDate(element, dateKey) {
            // Supprimer la sélection précédente
            document.querySelectorAll('.calendar-day').forEach(d => {
                d.style.backgroundColor = '';
            });

            // Ajouter la sélection actuelle
            element.style.backgroundColor = '#33334F';
            selectedDate = dateKey;
            
            renderEvents(dateKey);
        }

        function renderEvents(dateKey) {
            const events = state.events[dateKey] || [];
            const list = document.getElementById('event-list');
            const message = document.getElementById('event-list-message');
            document.getElementById('event-date-title').textContent = `Commandes pour le ${new Date(dateKey).toLocaleDateString('fr-FR', { day: 'numeric', month: 'long' })}`;
            list.innerHTML = '';
            
            if (events.length === 0) {
                message.style.display = 'block';
            } else {
                message.style.display = 'none';
                events.forEach((event, index) => {
                    const li = document.createElement('li');
                    li.textContent = event;
                    list.appendChild(li);
                });
            }
        }

        function addEvent() {
            if (!selectedDate) {
                alert("Veuillez d'abord sélectionner une date dans le calendrier.");
                return;
            }
            
            const input = document.getElementById('event-input');
            const eventText = input.value.trim();

            if (eventText) {
                if (!state.events[selectedDate]) {
                    state.events[selectedDate] = [];
                }
                state.events[selectedDate].push(eventText);
                
                // Sauvegarder dans localStorage
                localStorage.setItem('rbl_calendar_events', JSON.stringify(state.events));
                
                // Mettre à jour l'affichage
                renderEvents(selectedDate);
                renderCalendar(); // Pour ajouter le style 'has-event' au jour
                input.value = '';
                alert(`Commande planifiée pour le ${selectedDate} !`);
            }
        }
    </script>
</body>
</html>        /* ------------------------------------------------------------------ */
        /* INPUT PANEL */
        /* ------------------------------------------------------------------ */
        .input-panel { background: #151520; padding: 30px; border-radius: 10px; margin-bottom: 30px; }
        .input-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .input-group { margin-bottom: 15px; }
        .input-group label { display: block; font-size: 0.9em; margin-bottom: 5px; color: #FFD700; }
        .input-group input { width: 100%; padding: 12px; border-radius: 5px; border: 1px solid #333; background: #0A0A10; color: white; font-size: 1em; box-sizing: border-box; }
        #save-button { background: #FF0000; color: white; padding: 15px; border: none; border-radius: 5px; font-size: 1.1em; font-weight: bold; cursor: pointer; width: 100%; margin-top: 10px; transition: background 0.3s; }
        #save-button:hover { background: #cc0000; }

        /* ------------------------------------------------------------------ */
        /* CALENDAR STYLES */
        /* ------------------------------------------------------------------ */
        .calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .calendar-header button { background: none; border: none; color: #FFD700; font-size: 1.5em; cursor: pointer; }
        #month-year-display { font-size: 1.2em; font-weight: bold; }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); text-align: center; }
        .day-name { font-size: 0.8em; color: #AAAAAA; padding: 5px 0; }
        .calendar-day { 
            padding: 8px 0; 
            cursor: pointer; 
            border-radius: 50%; 
            transition: background 0.2s;
            position: relative;
        }
        .calendar-day:not(.empty-day):hover { background: #33334F; }
        .today { border: 2px solid #4CAF50; background: #223322 !important; color: #4CAF50; }
        .has-event { border: 2px solid #FF0000; }
        .current-month { color: #EAEAEA; }
        .other-month { color: #555555; }
        
        /* Event Display Panel */
        #event-display { margin-top: 25px; padding: 15px; background: #0A0A10; border-radius: 5px; min-height: 100px; }
        #event-display h3 { color: #FF0000; margin-top: 0; }
        #event-input { width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #333; background: #1C1C2C; color: white; margin-top: 10px; box-sizing: border-box;}
        #add-event-button { background: #FFD700; color: #121212; padding: 8px; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; margin-top: 10px; width: 100%; }
        #event-list { list-style: none; padding: 0; text-align: left; }
        #event-list li { margin-bottom: 5px; border-left: 3px solid #FF0000; padding-left: 10px; }

        /* ------------------------------------------------------------------ */
        /* SECURITY OVERLAY */
        /* ------------------------------------------------------------------ */
        #content-area { display: none; height: 100%; }
        #security-check { 
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); 
            max-width: 450px; padding: 40px; background: #1C1C2C; border-radius: 15px; 
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6); border: 1px solid #33334F; 
            text-align: center; color: #E0E0E0; z-index: 999; 
        }
    </style>
</head>
<body>
    <div id="security-check">
        <h1>🔐 Accès Sécurisé au Tableau de Bord</h1>
        <p>Accès refusé. Veuillez entrer le code mensuel pour déverrouiller cet outil de travail privé.</p>
        <input type="text" id="dashboard-code-input" placeholder="Code Mensuel (Ex: OCT2025)">
        <button onclick="checkCode()">Déverrouiller</button>
        <div id="security-result"></div>
    </div>
    
    <div id="content-area">
        <div class="dashboard-wrapper">
            
            <div class="sidebar">
                <p style="font-size: 0.9em; color: #AAAAAA; margin-bottom: 25px;">Code du mois : <span id="monthly-code" style="color: #4CAF50;"></span></p>

                <h2>🗓️ Calendrier des Commandes Planifiées</h2>
                
                <div class="calendar-header">
                    <button id="prev-month-button" onclick="changeMonth(-1)">&#9664;</button>
                    <span id="month-year-display"></span>
                    <button id="next-month-button" onclick="changeMonth(1)">&#9654;</button>
                </div>

                <div class="calendar-grid" id="calendar-grid">
                    <div class="day-name">Lun</div><div class="day-name">Mar</div><div class="day-name">Mer</div>
                    <div class="day-name">Jeu</div><div class="day-name">Ven</div><div class="day-name">Sam</div>
                    <div class="day-name">Dim</div>
                    </div>

                <div id="event-display">
                    <h3 id="event-date-title">Sélectionnez un jour</h3>
                    <p id="event-list-message" style="color:#FFD700; font-size:0.9em;">Aucune commande planifiée pour cette date.</p>
                    <ul id="event-list"></ul>
                    
                    <input type="text" id="event-input" placeholder="Ex: Commande 5 packs de Pierre" maxlength="50">
                    <button id="add-event-button" onclick="addEvent()">Ajouter la Commande</button>
                </div>

            </div>
            
            <div class="main-content">
                
                <h1>Espace de Travail - Gestion RBL LUXUURD</h1>
                <p id="current-datetime" style="color: #FFD700; font-weight: bold;"></p>

                <div class="widget-grid">
                    <div class="indicator-card" style="border-left: 5px solid #80CBC4;">
                        <h3>Revenus Totaux (€)</h3>
                        <p id="display-revenue">0.00</p>
                    </div>
                    <div class="indicator-card" style="border-left: 5px solid #FFCDD2;">
                        <h3>Dépenses Totales (€)</h3>
                        <p id="display-expense">0.00</p>
                    </div>
                    <div class="indicator-card" style="border-left: 5px solid #BBDEFB;">
                        <h3>Stock Actuel (Packs)</h3>
                        <p id="display-stock">0</p>
                    </div>
                </div>

                <div class="input-panel">
                    <h2>Enregistrement des Transactions</h2>
                    <div class="input-grid">
                        <div class="input-group">
                            <label for="input-revenue">Nouveau Revenu (€)</label>
                            <input type="number" id="input-revenue" placeholder="0.00" value="0.00">
                        </div>
                        <div class="input-group">
                            <label for="input-expense">Nouvelle Dépense (€)</label>
                            <input type="number" id="input-expense" placeholder="0.00" value="0.00">
                        </div>
                        <div class="input-group">
                            <label for="input-stock-in">Stock Reçu (+ Packs)</label>
                            <input type="number" id="input-stock-in" placeholder="0" value="0">
                        </div>
                        <div class="input-group">
                            <label for="input-stock-out">Stock Vendu (- Packs)</label>
                            <input type="number" id="input-stock-out" placeholder="0" value="0">
                        </div>
                    </div>
                    <button id="save-button" onclick="saveTransaction()">Ajouter Transaction & Mettre à jour les Totaux</button>
                    <p style="font-size: 0.8em; margin-top: 15px; color: #AAAAAA;">*Les totaux et les commandes du calendrier sont stockés dans le navigateur de cet appareil. Si vous effacez le cache, les données seront perdues.</p>
                </div>

            </div>
        </div>
    </div>

    <script>
        // ####################################################################
        // ########## PARAMÈTRES & SÉCURITÉ ###################################
        // ####################################################################
        const CORRECT_MONTHLY_CODE = "OCT2025"; 
        const NOW = new Date();
        let currentMonth = NOW.getMonth();
        let currentYear = NOW.getFullYear();
        let selectedDate = null;
        
        // Initialisation de l'état global
        let state = {
            revenue: 0,
            expense: 0,
            stock: 0,
            events: {} // Structure: {'YYYY-MM-DD': ['Event 1', 'Event 2']}
        };

        function checkCode() {
            const enteredCode = document.getElementById('dashboard-code-input').value.toUpperCase().trim();
            const resultElement = document.getElementById('security-result');

            if (enteredCode === CORRECT_MONTHLY_CODE) {
                document.getElementById('security-check').style.display = 'none';
                document.getElementById('content-area').style.display = 'block';
                localStorage.setItem('access_key_rbl', CORRECT_MONTHLY_CODE);
                loadData();
            } else {
                resultElement.textContent = "Code Invalide ou Expiré. ❌";
                resultElement.style.color = '#FF0000';
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            const savedKey = localStorage.getItem('access_key_rbl');
            if (savedKey === CORRECT_MONTHLY_CODE) {
                document.getElementById('security-check').style.display = 'none';
                document.getElementById('content-area').style.display = 'block';
                loadData();
            }
            document.getElementById('monthly-code').textContent = CORRECT_MONTHLY_CODE;
            updateDateTime();
            setInterval(updateDateTime, 1000); 
            renderCalendar();
        });
        
        function updateDateTime() {
            const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit' };
            const now = new Date();
            document.getElementById('current-datetime').textContent = `Date du jour : ${now.toLocaleDateString('fr-FR', dateOptions)} - ${now.toLocaleTimeString('fr-FR', timeOptions)}`;
        }

        // ####################################################################
        // ########## GESTION DES DONNÉES FINANCES/STOCK ######################
        // ####################################################################

        function loadData() {
            // Charge les totaux
            state.revenue = parseFloat(localStorage.getItem('rbl_total_revenue') || '0');
            state.expense = parseFloat(localStorage.getItem('rbl_total_expense') || '0');
            state.stock = parseInt(localStorage.getItem('rbl_current_stock') || '0');

            // Charge les événements du calendrier
            try {
                const storedEvents = localStorage.getItem('rbl_calendar_events');
                if (storedEvents) {
                    state.events = JSON.parse(storedEvents);
                }
            } catch (e) {
                console.error("Erreur lors du chargement des événements :", e);
                state.events = {};
            }
            
            updateDisplay();
            renderCalendar(); // Met à jour le calendrier après le chargement des événements
        }

        function updateDisplay() {
            document.getElementById('display-revenue').textContent = state.revenue.toFixed(2).replace('.', ',');
            document.getElementById('display-expense').textContent = state.expense.toFixed(2).replace('.', ',');
            document.getElementById('display-stock').textContent = state.stock;
        }

        function saveTransaction() {
            const revenueInput = parseFloat(document.getElementById('input-revenue').value) || 0;
            const expenseInput = parseFloat(document.getElementById('input-expense').value) || 0;
            const stockInInput = parseInt(document.getElementById('input-stock-in').value) || 0;
            const stockOutInput = parseInt(document.getElementById('input-stock-out').value) || 0;

            // Mettre à jour l'état
            state.revenue += revenueInput;
            state.expense += expenseInput;
            state.stock = state.stock + stockInInput - stockOutInput;
            
            // Sauvegarder dans le navigateur
            localStorage.setItem('rbl_total_revenue', state.revenue);
            localStorage.setItem('rbl_total_expense', state.expense);
            localStorage.setItem('rbl_current_stock', state.stock);

            // Réinitialiser les champs de saisie
            document.getElementById('input-revenue').value = '0.00';
            document.getElementById('input-expense').value = '0.00';
            document.getElementById('input-stock-in').value = '0';
            document.getElementById('input-stock-out').value = '0';
            
            updateDisplay();
            alert('Transaction sauvegardée localement !');
        }

        // ####################################################################
        // ########## LOGIQUE CALENDRIER ET ÉVÉNEMENTS ########################
        // ####################################################################

        const monthNames = ["Janvier", "Février", "Mars", "Avril", "Mai", "Juin", "Juillet", "Août", "Septembre", "Octobre", "Novembre", "Décembre"];

        function changeMonth(step) {
            currentMonth += step;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            } else if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            renderCalendar();
            document.getElementById('event-list').innerHTML = ''; // Nettoyer l'affichage de l'événement
            document.getElementById('event-date-title').textContent = 'Sélectionnez un jour';
            document.getElementById('event-list-message').style.display = 'block';
        }

        function renderCalendar() {
            document.getElementById('month-year-display').textContent = `${monthNames[currentMonth]} ${currentYear}`;
            const calendarGrid = document.getElementById('calendar-grid');
            
            // Nettoyer les jours (mais garder les noms des jours)
            const dayNamesCount = 7;
            while (calendarGrid.children.length > dayNamesCount) {
                calendarGrid.removeChild(calendarGrid.lastChild);
            }

            const firstDayOfMonth = new Date(currentYear, currentMonth, 1);
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            // getDay() renvoie 0 pour Dimanche, on veut 0 pour Lundi (Lundi=1, Dimanche=7)
            let startDay = firstDayOfMonth.getDay();
            if (startDay === 0) startDay = 7; // Convertir Dimanche (0) en 7
            let emptyDays = startDay - 1; // Nombre de jours vides avant le premier du mois

            // Jours vides
            for (let i = 0; i < emptyDays; i++) {
                const emptyDiv = document.createElement('div');
                emptyDiv.className = 'calendar-day empty-day';
                calendarGrid.appendChild(emptyDiv);
            }

            // Jours du mois
            for (let day = 1; day <= daysInMonth; day++) {
                const dateKey = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const dayDiv = document.createElement('div');
                dayDiv.className = 'calendar-day current-month';
                dayDiv.textContent = day;
                dayDiv.dataset.date = dateKey;
                dayDiv.onclick = () => selectDate(dayDiv, dateKey);

                // Marquer le jour actuel
                if (day === NOW.getDate() && currentMonth === NOW.getMonth() && currentYear === NOW.getFullYear()) {
                    dayDiv.classList.add('today');
                }
                
                // Marquer les jours avec des événements
                if (state.events[dateKey] && state.events[dateKey].length > 0) {
                    dayDiv.classList.add('has-event');
                }

                calendarGrid.appendChild(dayDiv);
            }
        }

        function selectDate(element, dateKey) {
            // Supprimer la sélection précédente
            document.querySelectorAll('.calendar-day').forEach(d => {
                d.style.backgroundColor = '';
            });

            // Ajouter la sélection actuelle
            element.style.backgroundColor = '#33334F';
            selectedDate = dateKey;
            
            renderEvents(dateKey);
        }

        function renderEvents(dateKey) {
            const events = state.events[dateKey] || [];
            const list = document.getElementById('event-list');
            const message = document.getElementById('event-list-message');
            document.getElementById('event-date-title').textContent = `Commandes pour le ${new Date(dateKey).toLocaleDateString('fr-FR', { day: 'numeric', month: 'long' })}`;
            list.innerHTML = '';
            
            if (events.length === 0) {
                message.style.display = 'block';
            } else {
                message.style.display = 'none';
                events.forEach((event, index) => {
                    const li = document.createElement('li');
                    li.textContent = event;
                    list.appendChild(li);
                });
            }
        }

        function addEvent() {
            if (!selectedDate) {
                alert("Veuillez d'abord sélectionner une date dans le calendrier.");
                return;
            }
            
            const input = document.getElementById('event-input');
            const eventText = input.value.trim();

            if (eventText) {
                if (!state.events[selectedDate]) {
                    state.events[selectedDate] = [];
                }
                state.events[selectedDate].push(eventText);
                
                // Sauvegarder dans localStorage
                localStorage.setItem('rbl_calendar_events', JSON.stringify(state.events));
                
                // Mettre à jour l'affichage
                renderEvents(selectedDate);
                renderCalendar(); // Pour ajouter le style 'has-event' au jour
                input.value = '';
                alert(`Commande planifiée pour le ${selectedDate} !`);
            }
        }
    </script>
</body>
</html>            cursor: pointer; 
            border-radius: 50%; 
            transition: background 0.2s;
            position: relative;
        }
        .calendar-day:not(.empty-day):hover { background: #33334F; }
        .today { border: 2px solid #4CAF50; background: #223322 !important; color: #4CAF50; }
        .has-event { border: 2px solid #FF0000; }
        .current-month { color: #EAEAEA; }
        .other-month { color: #555555; }
        
        /* Event Display Panel */
        #event-display { margin-top: 25px; padding: 15px; background: #0A0A10; border-radius: 5px; min-height: 100px; }
        #event-display h3 { color: #FF0000; margin-top: 0; }
        #event-input { width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #333; background: #1C1C2C; color: white; margin-top: 10px; box-sizing: border-box;}
        #add-event-button { background: #FFD700; color: #121212; padding: 8px; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; margin-top: 10px; width: 100%; }
        #event-list { list-style: none; padding: 0; text-align: left; }
        #event-list li { margin-bottom: 5px; border-left: 3px solid #FF0000; padding-left: 10px; }

        /* ------------------------------------------------------------------ */
        /* SECURITY OVERLAY */
        /* ------------------------------------------------------------------ */
        #content-area { display: none; height: 100%; }
        #security-check { 
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); 
            max-width: 450px; padding: 40px; background: #1C1C2C; border-radius: 15px; 
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6); border: 1px solid #33334F; 
            text-align: center; color: #E0E0E0; z-index: 999; 
        }
    </style>
</head>
<body>
    <div id="security-check">
        <h1>🔐 Accès Sécurisé au Tableau de Bord</h1>
        <p>Accès refusé. Veuillez entrer le code mensuel pour déverrouiller cet outil de travail privé.</p>
        <input type="text" id="dashboard-code-input" placeholder="Code Mensuel (Ex: OCT2025)">
        <button onclick="checkCode()">Déverrouiller</button>
        <div id="security-result"></div>
    </div>
    
    <div id="content-area">
        <div class="dashboard-wrapper">
            
            <div class="sidebar">
                <p style="font-size: 0.9em; color: #AAAAAA; margin-bottom: 25px;">Code du mois : <span id="monthly-code" style="color: #4CAF50;"></span></p>

                <h2>🗓️ Calendrier des Commandes Planifiées</h2>
                
                <div class="calendar-header">
                    <button id="prev-month-button" onclick="changeMonth(-1)">&#9664;</button>
                    <span id="month-year-display"></span>
                    <button id="next-month-button" onclick="changeMonth(1)">&#9654;</button>
                </div>

                <div class="calendar-grid" id="calendar-grid">
                    <div class="day-name">Lun</div><div class="day-name">Mar</div><div class="day-name">Mer</div>
                    <div class="day-name">Jeu</div><div class="day-name">Ven</div><div class="day-name">Sam</div>
                    <div class="day-name">Dim</div>
                    </div>

                <div id="event-display">
                    <h3 id="event-date-title">Sélectionnez un jour</h3>
                    <p id="event-list-message" style="color:#FFD700; font-size:0.9em;">Aucune commande planifiée pour cette date.</p>
                    <ul id="event-list"></ul>
                    
                    <input type="text" id="event-input" placeholder="Ex: Commande 5 packs de Pierre" maxlength="50">
                    <button id="add-event-button" onclick="addEvent()">Ajouter la Commande</button>
                </div>

            </div>
            
            <div class="main-content">
                
                <h1>Espace de Travail - Gestion RBL LUXUURD</h1>
                <p id="current-datetime" style="color: #FFD700; font-weight: bold;"></p>

                <div class="widget-grid">
                    <div class="indicator-card" style="border-left: 5px solid #80CBC4;">
                        <h3>Revenus Totaux (€)</h3>
                        <p id="display-revenue">0.00</p>
                    </div>
                    <div class="indicator-card" style="border-left: 5px solid #FFCDD2;">
                        <h3>Dépenses Totales (€)</h3>
                        <p id="display-expense">0.00</p>
                    </div>
                    <div class="indicator-card" style="border-left: 5px solid #BBDEFB;">
                        <h3>Stock Actuel (Packs)</h3>
                        <p id="display-stock">0</p>
                    </div>
                </div>

                <div class="input-panel">
                    <h2>Enregistrement des Transactions</h2>
                    <div class="input-grid">
                        <div class="input-group">
                            <label for="input-revenue">Nouveau Revenu (€)</label>
                            <input type="number" id="input-revenue" placeholder="0.00" value="0.00">
                        </div>
                        <div class="input-group">
                            <label for="input-expense">Nouvelle Dépense (€)</label>
                            <input type="number" id="input-expense" placeholder="0.00" value="0.00">
                        </div>
                        <div class="input-group">
                            <label for="input-stock-in">Stock Reçu (+ Packs)</label>
                            <input type="number" id="input-stock-in" placeholder="0" value="0">
                        </div>
                        <div class="input-group">
                            <label for="input-stock-out">Stock Vendu (- Packs)</label>
                            <input type="number" id="input-stock-out" placeholder="0" value="0">
                        </div>
                    </div>
                    <button id="save-button" onclick="saveTransaction()">Ajouter Transaction & Mettre à jour les Totaux</button>
                    <p style="font-size: 0.8em; margin-top: 15px; color: #AAAAAA;">*Les totaux et les commandes du calendrier sont stockés dans le navigateur de cet appareil. Si vous effacez le cache, les données seront perdues.</p>
                </div>

            </div>
        </div>
    </div>

    <script>
        // ####################################################################
        // ########## PARAMÈTRES & SÉCURITÉ ###################################
        // ####################################################################
        const CORRECT_MONTHLY_CODE = "OCT2025"; 
        const NOW = new Date();
        let currentMonth = NOW.getMonth();
        let currentYear = NOW.getFullYear();
        let selectedDate = null;
        
        // Initialisation de l'état global
        let state = {
            revenue: 0,
            expense: 0,
            stock: 0,
            events: {} // Structure: {'YYYY-MM-DD': ['Event 1', 'Event 2']}
        };

        function checkCode() {
            const enteredCode = document.getElementById('dashboard-code-input').value.toUpperCase().trim();
            const resultElement = document.getElementById('security-result');

            if (enteredCode === CORRECT_MONTHLY_CODE) {
                document.getElementById('security-check').style.display = 'none';
                document.getElementById('content-area').style.display = 'block';
                localStorage.setItem('access_key_rbl', CORRECT_MONTHLY_CODE);
                loadData();
            } else {
                resultElement.textContent = "Code Invalide ou Expiré. ❌";
                resultElement.style.color = '#FF0000';
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            const savedKey = localStorage.getItem('access_key_rbl');
            if (savedKey === CORRECT_MONTHLY_CODE) {
                document.getElementById('security-check').style.display = 'none';
                document.getElementById('content-area').style.display = 'block';
                loadData();
            }
            document.getElementById('monthly-code').textContent = CORRECT_MONTHLY_CODE;
            updateDateTime();
            setInterval(updateDateTime, 1000); 
            renderCalendar();
        });
        
        function updateDateTime() {
            const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit' };
            const now = new Date();
            document.getElementById('current-datetime').textContent = `Date du jour : ${now.toLocaleDateString('fr-FR', dateOptions)} - ${now.toLocaleTimeString('fr-FR', timeOptions)}`;
        }


        // ####################################################################
        // ########## GESTION DES DONNÉES FINANCES/STOCK ######################
        // ####################################################################

        function loadData() {
            // Charge les totaux
            state.revenue = parseFloat(localStorage.getItem('rbl_total_revenue') || '0');
            state.expense = parseFloat(localStorage.getItem('rbl_total_expense') || '0');
            state.stock = parseInt(localStorage.getItem('rbl_current_stock') || '0');

            // Charge les événements du calendrier
            try {
                const storedEvents = localStorage.getItem('rbl_calendar_events');
                if (storedEvents) {
                    state.events = JSON.parse(storedEvents);
                }
            } catch (e) {
                console.error("Erreur lors du chargement des événements :", e);
                state.events = {};
            }
            
            updateDisplay();
            renderCalendar(); // Met à jour le calendrier après le chargement des événements
        }

        function updateDisplay() {
            document.getElementById('display-revenue').textContent = state.revenue.toFixed(2).replace('.', ',');
            document.getElementById('display-expense').textContent = state.expense.toFixed(2).replace('.', ',');
            document.getElementById('display-stock').textContent = state.stock;
        }

        function saveTransaction() {
            const revenueInput = parseFloat(document.getElementById('input-revenue').value) || 0;
            const expenseInput = parseFloat(document.getElementById('input-expense').value) || 0;
            const stockInInput = parseInt(document.getElementById('input-stock-in').value) || 0;
            const stockOutInput = parseInt(document.getElementById('input-stock-out').value) || 0;

            // Mettre à jour l'état
            state.revenue += revenueInput;
            state.expense += expenseInput;
            state.stock = state.stock + stockInInput - stockOutInput;
            
            // Sauvegarder dans le navigateur
            localStorage.setItem('rbl_total_revenue', state.revenue);
            localStorage.setItem('rbl_total_expense', state.expense);
            localStorage.setItem('rbl_current_stock', state.stock);

            // Réinitialiser les champs de saisie
            document.getElementById('input-revenue').value = '0.00';
            document.getElementById('input-expense').value = '0.00';
            document.getElementById('input-stock-in').value = '0';
            document.getElementById('input-stock-out').value = '0';
            
            updateDisplay();
            alert('Transaction sauvegardée localement !');
        }

        // ####################################################################
        // ########## LOGIQUE CALENDRIER ET ÉVÉNEMENTS ########################
        // ####################################################################

        const monthNames = ["Janvier", "Février", "Mars", "Avril", "Mai", "Juin", "Juillet", "Août", "Septembre", "Octobre", "Novembre", "Décembre"];

        function changeMonth(step) {
            currentMonth += step;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            } else if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            renderCalendar();
            document.getElementById('event-list').innerHTML = ''; // Nettoyer l'affichage de l'événement
            document.getElementById('event-date-title').textContent = 'Sélectionnez un jour';
            document.getElementById('event-list-message').style.display = 'block';
        }

        function renderCalendar() {
            document.getElementById('month-year-display').textContent = `${monthNames[currentMonth]} ${currentYear}`;
            const calendarGrid = document.getElementById('calendar-grid');
            
            // Nettoyer les jours (mais garder les noms des jours)
            const dayNamesCount = 7;
            while (calendarGrid.children.length > dayNamesCount) {
                calendarGrid.removeChild(calendarGrid.lastChild);
            }

            const firstDayOfMonth = new Date(currentYear, currentMonth, 1);
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            // getDay() renvoie 0 pour Dimanche, on veut 0 pour Lundi (Lundi=1, Dimanche=7)
            let startDay = firstDayOfMonth.getDay();
            if (startDay === 0) startDay = 7; // Convertir Dimanche (0) en 7
            let emptyDays = startDay - 1; // Nombre de jours vides avant le premier du mois

            // Jours vides
            for (let i = 0; i < emptyDays; i++) {
                const emptyDiv = document.createElement('div');
                emptyDiv.className = 'calendar-day empty-day';
                calendarGrid.appendChild(emptyDiv);
            }

            // Jours du mois
            for (let day = 1; day <= daysInMonth; day++) {
                const dateKey = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const dayDiv = document.createElement('div');
                dayDiv.className = 'calendar-day current-month';
                dayDiv.textContent = day;
                dayDiv.dataset.date = dateKey;
                dayDiv.onclick = () => selectDate(dayDiv, dateKey);

                // Marquer le jour actuel
                if (day === NOW.getDate() && currentMonth === NOW.getMonth() && currentYear === NOW.getFullYear()) {
                    dayDiv.classList.add('today');
                }
                
                // Marquer les jours avec des événements
                if (state.events[dateKey] && state.events[dateKey].length > 0) {
                    dayDiv.classList.add('has-event');
                }

                calendarGrid.appendChild(dayDiv);
            }
        }

        function selectDate(element, dateKey) {
            // Supprimer la sélection précédente
            document.querySelectorAll('.calendar-day').forEach(d => {
                d.style.backgroundColor = '';
            });

            // Ajouter la sélection actuelle
            element.style.backgroundColor = '#33334F';
            selectedDate = dateKey;
            
            renderEvents(dateKey);
        }

        function renderEvents(dateKey) {
            const events = state.events[dateKey] || [];
            const list = document.getElementById('event-list');
            const message = document.getElementById('event-list-message');
            document.getElementById('event-date-title').textContent = `Commandes pour le ${new Date(dateKey).toLocaleDateString('fr-FR', { day: 'numeric', month: 'long' })}`;
            list.innerHTML = '';
            
            if (events.length === 0) {
                message.style.display = 'block';
            } else {
                message.style.display = 'none';
                events.forEach((event, index) => {
                    const li = document.createElement('li');
                    li.textContent = event;
                    list.appendChild(li);
                });
            }
        }

        function addEvent() {
            if (!selectedDate) {
                alert("Veuillez d'abord sélectionner une date dans le calendrier.");
                return;
            }
            
            const input = document.getElementById('event-input');
            const eventText = input.value.trim();

            if (eventText) {
                if (!state.events[selectedDate]) {
                    state.events[selectedDate] = [];
                }
                state.events[selectedDate].push(eventText);
                
                // Sauvegarder dans localStorage
                localStorage.setItem('rbl_calendar_events', JSON.stringify(state.events));
                
                // Mettre à jour l'affichage
                renderEvents(selectedDate);
                renderCalendar(); // Pour ajouter le style 'has-event' au jour
                input.value = '';
                alert(`Commande planifiée pour le ${selectedDate} !`);
            }
        }
    </script>
</body>
</html>        #event-input { width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #333; background: #1C1C2C; color: white; margin-top: 10px; box-sizing: border-box;}
        #add-event-button { background: #FFD700; color: #121212; padding: 8px; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; margin-top: 10px; width: 100%; }
        #event-list { list-style: none; padding: 0; text-align: left; }
        #event-list li { margin-bottom: 5px; border-left: 3px solid #FF0000; padding-left: 10px; }

        /* ------------------------------------------------------------------ */
        /* SECURITY OVERLAY */
        /* ------------------------------------------------------------------ */
        #content-area { display: none; height: 100%; }
        #security-check { 
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); 
            max-width: 450px; padding: 40px; background: #1C1C2C; border-radius: 15px; 
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6); border: 1px solid #33334F; 
            text-align: center; color: #E0E0E0; z-index: 999; 
        }
    </style>
</head>
<body>
    <div id="security-check">
        <h1>🔐 Accès Sécurisé au Tableau de Bord</h1>
        <p>Accès refusé. Veuillez entrer le code mensuel pour déverrouiller cet outil de travail privé.</p>
        <input type="text" id="dashboard-code-input" placeholder="Code Mensuel (Ex: OCT2025)">
        <button onclick="checkCode()">Déverrouiller</button>
        <div id="security-result"></div>
    </div>
    
    <div id="content-area">
        <div class="dashboard-wrapper">
            
            <div class="sidebar">
                <p style="font-size: 0.9em; color: #AAAAAA; margin-bottom: 25px;">Code du mois : <span id="monthly-code" style="color: #4CAF50;"></span></p>

                <h2>🗓️ Calendrier des Commandes Planifiées</h2>
                
                <div class="calendar-header">
                    <button id="prev-month-button" onclick="changeMonth(-1)">&#9664;</button>
                    <span id="month-year-display"></span>
                    <button id="next-month-button" onclick="changeMonth(1)">&#9654;</button>
                </div>

                <div class="calendar-grid" id="calendar-grid">
                    <div class="day-name">Lun</div><div class="day-name">Mar</div><div class="day-name">Mer</div>
                    <div class="day-name">Jeu</div><div class="day-name">Ven</div><div class="day-name">Sam</div>
                    <div class="day-name">Dim</div>
                    </div>

                <div id="event-display">
                    <h3 id="event-date-title">Sélectionnez un jour</h3>
                    <p id="event-list-message" style="color:#FFD700; font-size:0.9em;">Aucune commande planifiée pour cette date.</p>
                    <ul id="event-list"></ul>
                    
                    <input type="text" id="event-input" placeholder="Ex: Commande 5 packs de Pierre" maxlength="50">
                    <button id="add-event-button" onclick="addEvent()">Ajouter la Commande</button>
                </div>

            </div>
            
            <div class="main-content">
                
                <h1>Espace de Travail - Gestion RBL LUXUURD</h1>
                <p id="current-datetime" style="color: #FFD700; font-weight: bold;"></p>

                <div class="widget-grid">
                    <div class="indicator-card" style="border-left: 5px solid #80CBC4;">
                        <h3>Revenus Totaux (€)</h3>
                        <p id="display-revenue">0.00</p>
                    </div>
                    <div class="indicator-card" style="border-left: 5px solid #FFCDD2;">
                        <h3>Dépenses Totales (€)</h3>
                        <p id="display-expense">0.00</p>
                    </div>
                    <div class="indicator-card" style="border-left: 5px solid #BBDEFB;">
                        <h3>Stock Actuel (Packs)</h3>
                        <p id="display-stock">0</p>
                    </div>
                </div>

                <div class="input-panel">
                    <h2>Enregistrement des Transactions</h2>
                    <div class="input-grid">
                        <div class="input-group">
                            <label for="input-revenue">Nouveau Revenu (€)</label>
                            <input type="number" id="input-revenue" placeholder="0.00" value="0.00">
                        </div>
                        <div class="input-group">
                            <label for="input-expense">Nouvelle Dépense (€)</label>
                            <input type="number" id="input-expense" placeholder="0.00" value="0.00">
                        </div>
                        <div class="input-group">
                            <label for="input-stock-in">Stock Reçu (+ Packs)</label>
                            <input type="number" id="input-stock-in" placeholder="0" value="0">
                        </div>
                        <div class="input-group">
                            <label for="input-stock-out">Stock Vendu (- Packs)</label>
                            <input type="number" id="input-stock-out" placeholder="0" value="0">
                        </div>
                    </div>
                    <button id="save-button" onclick="saveTransaction()">Ajouter Transaction & Mettre à jour les Totaux</button>
                    <p style="font-size: 0.8em; margin-top: 15px; color: #AAAAAA;">*Les totaux et les commandes du calendrier sont stockés dans le navigateur de cet appareil. Si vous effacez le cache, les données seront perdues.</p>
                </div>

            </div>
        </div>
    </div>

    <script>
        // ####################################################################
        // ########## PARAMÈTRES & SÉCURITÉ ###################################
        // ####################################################################
        const CORRECT_MONTHLY_CODE = "OCT2025"; 
        const NOW = new Date();
        let currentMonth = NOW.getMonth();
        let currentYear = NOW.getFullYear();
        let selectedDate = null;
        
        // Initialisation de l'état global
        let state = {
            revenue: 0,
            expense: 0,
            stock: 0,
            events: {} // Structure: {'YYYY-MM-DD': ['Event 1', 'Event 2']}
        };

        function checkCode() {
            const enteredCode = document.getElementById('dashboard-code-input').value.toUpperCase().trim();
            const resultElement = document.getElementById('security-result');

            if (enteredCode === CORRECT_MONTHLY_CODE) {
                document.getElementById('security-check').style.display = 'none';
                document.getElementById('content-area').style.display = 'block';
                localStorage.setItem('access_key_rbl', CORRECT_MONTHLY_CODE);
                loadData();
            } else {
                resultElement.textContent = "Code Invalide ou Expiré. ❌";
                resultElement.style.color = '#FF0000';
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            const savedKey = localStorage.getItem('access_key_rbl');
            if (savedKey === CORRECT_MONTHLY_CODE) {
                document.getElementById('security-check').style.display = 'none';
                document.getElementById('content-area').style.display = 'block';
                loadData();
            }
            document.getElementById('monthly-code').textContent = CORRECT_MONTHLY_CODE;
            updateDateTime();
            setInterval(updateDateTime, 1000); 
            renderCalendar();
        });
        
        function updateDateTime() {
            const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit' };
            const now = new Date();
            document.getElementById('current-datetime').textContent = `Date du jour : ${now.toLocaleDateString('fr-FR', dateOptions)} - ${now.toLocaleTimeString('fr-FR', timeOptions)}`;
        }

        // ####################################################################
        // ########## GESTION DES DONNÉES FINANCES/STOCK ######################
        // ####################################################################

        function loadData() {
            // Charge les totaux
            state.revenue = parseFloat(localStorage.getItem('rbl_total_revenue') || '0');
            state.expense = parseFloat(localStorage.getItem('rbl_total_expense') || '0');
            state.stock = parseInt(localStorage.getItem('rbl_current_stock') || '0');

            // Charge les événements du calendrier
            try {
                const storedEvents = localStorage.getItem('rbl_calendar_events');
                if (storedEvents) {
                    state.events = JSON.parse(storedEvents);
                }
            } catch (e) {
                console.error("Erreur lors du chargement des événements :", e);
                state.events = {};
            }
            
            updateDisplay();
            renderCalendar(); // Met à jour le calendrier après le chargement des événements
        }

        function updateDisplay() {
            document.getElementById('display-revenue').textContent = state.revenue.toFixed(2).replace('.', ',');
            document.getElementById('display-expense').textContent = state.expense.toFixed(2).replace('.', ',');
            document.getElementById('display-stock').textContent = state.stock;
        }

        function saveTransaction() {
            const revenueInput = parseFloat(document.getElementById('input-revenue').value) || 0;
            const expenseInput = parseFloat(document.getElementById('input-expense').value) || 0;
            const stockInInput = parseInt(document.getElementById('input-stock-in').value) || 0;
            const stockOutInput = parseInt(document.getElementById('input-stock-out').value) || 0;

            // Mettre à jour l'état
            state.revenue += revenueInput;
            state.expense += expenseInput;
            state.stock = state.stock + stockInInput - stockOutInput;
            
            // Sauvegarder dans le navigateur
            localStorage.setItem('rbl_total_revenue', state.revenue);
            localStorage.setItem('rbl_total_expense', state.expense);
            localStorage.setItem('rbl_current_stock', state.stock);

            // Réinitialiser les champs de saisie
            document.getElementById('input-revenue').value = '0.00';
            document.getElementById('input-expense').value = '0.00';
            document.getElementById('input-stock-in').value = '0';
            document.getElementById('input-stock-out').value = '0';
            
            updateDisplay();
            alert('Transaction sauvegardée localement !');
        }

        // ####################################################################
        // ########## LOGIQUE CALENDRIER ET ÉVÉNEMENTS ########################
        // ####################################################################

        const monthNames = ["Janvier", "Février", "Mars", "Avril", "Mai", "Juin", "Juillet", "Août", "Septembre", "Octobre", "Novembre", "Décembre"];

        function changeMonth(step) {
            currentMonth += step;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            } else if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            renderCalendar();
            document.getElementById('event-list').innerHTML = ''; // Nettoyer l'affichage de l'événement
            document.getElementById('event-date-title').textContent = 'Sélectionnez un jour';
            document.getElementById('event-list-message').style.display = 'block';
        }

        function renderCalendar() {
            document.getElementById('month-year-display').textContent = `${monthNames[currentMonth]} ${currentYear}`;
            const calendarGrid = document.getElementById('calendar-grid');
            
            // Nettoyer les jours (mais garder les noms des jours)
            const dayNamesCount = 7;
            while (calendarGrid.children.length > dayNamesCount) {
                calendarGrid.removeChild(calendarGrid.lastChild);
            }

            const firstDayOfMonth = new Date(currentYear, currentMonth, 1);
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            // getDay() renvoie 0 pour Dimanche, on veut 0 pour Lundi (Lundi=1, Dimanche=7)
            let startDay = firstDayOfMonth.getDay();
            if (startDay === 0) startDay = 7; // Convertir Dimanche (0) en 7
            let emptyDays = startDay - 1; // Nombre de jours vides avant le premier du mois

            // Jours vides
            for (let i = 0; i < emptyDays; i++) {
                const emptyDiv = document.createElement('div');
                emptyDiv.className = 'calendar-day empty-day';
                calendarGrid.appendChild(emptyDiv);
            }

            // Jours du mois
            for (let day = 1; day <= daysInMonth; day++) {
                const dateKey = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const dayDiv = document.createElement('div');
                dayDiv.className = 'calendar-day current-month';
                dayDiv.textContent = day;
                dayDiv.dataset.date = dateKey;
                dayDiv.onclick = () => selectDate(dayDiv, dateKey);

                // Marquer le jour actuel
                if (day === NOW.getDate() && currentMonth === NOW.getMonth() && currentYear === NOW.getFullYear()) {
                    dayDiv.classList.add('today');
                }
                
                // Marquer les jours avec des événements
                if (state.events[dateKey] && state.events[dateKey].length > 0) {
                    dayDiv.classList.add('has-event');
                }

                calendarGrid.appendChild(dayDiv);
            }
        }

        function selectDate(element, dateKey) {
            // Supprimer la sélection précédente
            document.querySelectorAll('.calendar-day').forEach(d => {
                d.style.backgroundColor = '';
            });

            // Ajouter la sélection actuelle
            element.style.backgroundColor = '#33334F';
            selectedDate = dateKey;
            
            renderEvents(dateKey);
        }

        function renderEvents(dateKey) {
            const events = state.events[dateKey] || [];
            const list = document.getElementById('event-list');
            const message = document.getElementById('event-list-message');
            document.getElementById('event-date-title').textContent = `Commandes pour le ${new Date(dateKey).toLocaleDateString('fr-FR', { day: 'numeric', month: 'long' })}`;
            list.innerHTML = '';
            
            if (events.length === 0) {
                message.style.display = 'block';
            } else {
                message.style.display = 'none';
                events.forEach((event, index) => {
                    const li = document.createElement('li');
                    li.textContent = event;
                    list.appendChild(li);
                });
            }
        }

        function addEvent() {
            if (!selectedDate) {
                alert("Veuillez d'abord sélectionner une date dans le calendrier.");
                return;
            }
            
            const input = document.getElementById('event-input');
            const eventText = input.value.trim();

            if (eventText) {
                if (!state.events[selectedDate]) {
                    state.events[selectedDate] = [];
                }
                state.events[selectedDate].push(eventText);
                
                // Sauvegarder dans localStorage
                localStorage.setItem('rbl_calendar_events', JSON.stringify(state.events));
                
                // Mettre à jour l'affichage
                renderEvents(selectedDate);
                renderCalendar(); // Pour ajouter le style 'has-event' au jour
                input.value = '';
                alert(`Commande planifiée pour le ${selectedDate} !`);
            }
        }
    </script>
</body>
</html>



        /* ------------------------------------------------------------------ */
        /* INPUT PANEL */
        /* ------------------------------------------------------------------ */
        .input-panel { background: #151520; padding: 30px; border-radius: 10px; margin-bottom: 30px; }
        .input-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .input-group { margin-bottom: 15px; }
        .input-group label { display: block; font-size: 0.9em; margin-bottom: 5px; color: #FFD700; }
        .input-group input { width: 100%; padding: 12px; border-radius: 5px; border: 1px solid #333; background: #0A0A10; color: white; font-size: 1em; box-sizing: border-box; }
        #save-button { background: #FF0000; color: white; padding: 15px; border: none; border-radius: 5px; font-size: 1.1em; font-weight: bold; cursor: pointer; width: 100%; margin-top: 10px; transition: background 0.3s; }
        #save-button:hover { background: #cc0000; }

        /* ------------------------------------------------------------------ */
        /* CALENDAR STYLES */
        /* ------------------------------------------------------------------ */
        .calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .calendar-header button { background: none; border: none; color: #FFD700; font-size: 1.5em; cursor: pointer; }
        #month-year-display { font-size: 1.2em; font-weight: bold; }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); text-align: center; }
        .day-name { font-size: 0.8em; color: #AAAAAA; padding: 5px 0; }
        .calendar-day { 
            padding: 8px 0; 
            cursor: pointer; 
            border-radius: 50%; 
            transition: background 0.2s;
            position: relative;
        }
        .calendar-day:not(.empty-day):hover { background: #33334F; }
        .today { border: 2px solid #4CAF50; background: #223322 !important; color: #4CAF50; }
        .has-event { border: 2px solid #FF0000; }
        .current-month { color: #EAEAEA; }
        .other-month { color: #555555; }
        
        /* Event Display Panel */
        #event-display { margin-top: 25px; padding: 15px; background: #0A0A10; border-radius: 5px; min-height: 100px; }
        #event-display h3 { color: #FF0000; margin-top: 0; }
        #event-input { width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #333; background: #1C1C2C; color: white; margin-top: 10px; box-sizing: border-box;}
        #add-event-button { background: #FFD700; color: #121212; padding: 8px; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; margin-top: 10px; width: 100%; }
        #event-list { list-style: none; padding: 0; text-align: left; }
        #event-list li { margin-bottom: 5px; border-left: 3px solid #FF0000; padding-left: 10px; }

        /* ------------------------------------------------------------------ */
        /* SECURITY OVERLAY */
        /* ------------------------------------------------------------------ */
        #content-area { display: none; height: 100%; }
        #security-check { 
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); 
            max-width: 450px; padding: 40px; background: #1C1C2C; border-radius: 15px; 
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6); border: 1px solid #33334F; 
            text-align: center; color: #E0E0E0; z-index: 999; 
        }
    </style>
</head>
<body>
    <div id="security-check">
        <h1>🔐 Accès Sécurisé au Tableau de Bord</h1>
        <p>Accès refusé. Veuillez entrer le code mensuel pour déverrouiller cet outil de travail privé.</p>
        <input type="text" id="dashboard-code-input" placeholder="Code Mensuel (Ex: OCT2025)">
        <button onclick="checkCode()">Déverrouiller</button>
        <div id="security-result"></div>
    </div>
    
    <div id="content-area">
        <div class="dashboard-wrapper">
            
            <div class="sidebar">
                <p style="font-size: 0.9em; color: #AAAAAA; margin-bottom: 25px;">Code du mois : <span id="monthly-code" style="color: #4CAF50;"></span></p>

                <h2>🗓️ Calendrier des Commandes Planifiées</h2>
                
                <div class="calendar-header">
                    <button id="prev-month-button" onclick="changeMonth(-1)">&#9664;</button>
                    <span id="month-year-display"></span>
                    <button id="next-month-button" onclick="changeMonth(1)">&#9654;</button>
                </div>

                <div class="calendar-grid" id="calendar-grid">
                    <div class="day-name">Lun</div><div class="day-name">Mar</div><div class="day-name">Mer</div>
                    <div class="day-name">Jeu</div><div class="day-name">Ven</div><div class="day-name">Sam</div>
                    <div class="day-name">Dim</div>
                    </div>

                <div id="event-display">
                    <h3 id="event-date-title">Sélectionnez un jour</h3>
                    <p id="event-list-message" style="color:#FFD700; font-size:0.9em;">Aucune commande planifiée pour cette date.</p>
                    <ul id="event-list"></ul>
                    
                    <input type="text" id="event-input" placeholder="Ex: Commande 5 packs de Pierre" maxlength="50">
                    <button id="add-event-button" onclick="addEvent()">Ajouter la Commande</button>
                </div>

            </div>
            
            <div class="main-content">
                
                <h1>Espace de Travail - Gestion RBL LUXUURD</h1>
                <p id="current-datetime" style="color: #FFD700; font-weight: bold;"></p>

                <div class="widget-grid">
                    <div class="indicator-card" style="border-left: 5px solid #80CBC4;">
                        <h3>Revenus Totaux (€)</h3>
                        <p id="display-revenue">0.00</p>
                    </div>
                    <div class="indicator-card" style="border-left: 5px solid #FFCDD2;">
                        <h3>Dépenses Totales (€)</h3>
                        <p id="display-expense">0.00</p>
                    </div>
                    <div class="indicator-card" style="border-left: 5px solid #BBDEFB;">
                        <h3>Stock Actuel (Packs)</h3>
                        <p id="display-stock">0</p>
                    </div>
                </div>

                <div class="input-panel">
                    <h2>Enregistrement des Transactions</h2>
                    <div class="input-grid">
                        <div class="input-group">
                            <label for="input-revenue">Nouveau Revenu (€)</label>
                            <input type="number" id="input-revenue" placeholder="0.00" value="0.00">
                        </div>
                        <div class="input-group">
                            <label for="input-expense">Nouvelle Dépense (€)</label>
                            <input type="number" id="input-expense" placeholder="0.00" value="0.00">
                        </div>
                        <div class="input-group">
                            <label for="input-stock-in">Stock Reçu (+ Packs)</label>
                            <input type="number" id="input-stock-in" placeholder="0" value="0">
                        </div>
                        <div class="input-group">
                            <label for="input-stock-out">Stock Vendu (- Packs)</label>
                            <input type="number" id="input-stock-out" placeholder="0" value="0">
                        </div>
                    </div>
                    <button id="save-button" onclick="saveTransaction()">Ajouter Transaction & Mettre à jour les Totaux</button>
                    <p style="font-size: 0.8em; margin-top: 15px; color: #AAAAAA;">*Les totaux et les commandes du calendrier sont stockés dans le navigateur de cet appareil. Si vous effacez le cache, les données seront perdues.</p>
                </div>

            </div>
        </div>
    </div>

    <script>
        // ####################################################################
        // ########## PARAMÈTRES & SÉCURITÉ ###################################
        // ####################################################################
        const CORRECT_MONTHLY_CODE = "OCT2025"; 
        const NOW = new Date();
        let currentMonth = NOW.getMonth();
        let currentYear = NOW.getFullYear();
        let selectedDate = null;
        
        // Initialisation de l'état global
        let state = {
            revenue: 0,
            expense: 0,
            stock: 0,
            events: {} // Structure: {'YYYY-MM-DD': ['Event 1', 'Event 2']}
        };

        function checkCode() {
            const enteredCode = document.getElementById('dashboard-code-input').value.toUpperCase().trim();
            const resultElement = document.getElementById('security-result');

            if (enteredCode === CORRECT_MONTHLY_CODE) {
                document.getElementById('security-check').style.display = 'none';
                document.getElementById('content-area').style.display = 'block';
                localStorage.setItem('access_key_rbl', CORRECT_MONTHLY_CODE);
                loadData();
            } else {
                resultElement.textContent = "Code Invalide ou Expiré. ❌";
                resultElement.style.color = '#FF0000';
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            // Vérification du code dans l'URL (si on vient du Portail)
            const urlParams = new URLSearchParams(window.location.search);
            const urlKey = urlParams.get('key');

            if (urlKey === CORRECT_MONTHLY_CODE) {
                document.getElementById('security-check').style.display = 'none';
                document.getElementById('content-area').style.display = 'block';
                localStorage.setItem('access_key_rbl', CORRECT_MONTHLY_CODE);
                loadData();
            } else {
                 // Vérification du code dans le LocalStorage (si on revient sur la page)
                const savedKey = localStorage.getItem('access_key_rbl');
                if (savedKey === CORRECT_MONTHLY_CODE) {
                    document.getElementById('security-check').style.display = 'none';
                    document.getElementById('content-area').style.display = 'block';
                    loadData();
                }
            }

            document.getElementById('monthly-code').textContent = CORRECT_MONTHLY_CODE;
            updateDateTime();
            setInterval(updateDateTime, 1000); 
            renderCalendar();
        });
        
        function updateDateTime() {
            const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit' };
            const now = new Date();
            document.getElementById('current-datetime').textContent = `Date du jour : ${now.toLocaleDateString('fr-FR', dateOptions)} - ${now.toLocaleTimeString('fr-FR', timeOptions)}`;
        }


        // ####################################################################
        // ########## GESTION DES DONNÉES FINANCES/STOCK ######################
        // ####################################################################

        function loadData() {
            // Charge les totaux
            state.revenue = parseFloat(localStorage.getItem('rbl_total_revenue') || '0');
            state.expense = parseFloat(localStorage.getItem('rbl_total_expense') || '0');
            state.stock = parseInt(localStorage.getItem('rbl_current_stock') || '0');

            // Charge les événements du calendrier
            try {
                const storedEvents = localStorage.getItem('rbl_calendar_events');
                if (storedEvents) {
                    state.events = JSON.parse(storedEvents);
                }
            } catch (e) {
                console.error("Erreur lors du chargement des événements :", e);
                state.events = {};
            }
            
            updateDisplay();
            renderCalendar(); // Met à jour le calendrier après le chargement des événements
        }

        function updateDisplay() {
            document.getElementById('display-revenue').textContent = state.revenue.toFixed(2).replace('.', ',');
            document.getElementById('display-expense').textContent = state.expense.toFixed(2).replace('.', ',');
            document.getElementById('display-stock').textContent = state.stock;
        }

        function saveTransaction() {
            const revenueInput = parseFloat(document.getElementById('input-revenue').value) || 0;
            const expenseInput = parseFloat(document.getElementById('input-expense').value) || 0;
            const stockInInput = parseInt(document.getElementById('input-stock-in').value) || 0;
            const stockOutInput = parseInt(document.getElementById('input-stock-out').value) || 0;

            // Mettre à jour l'état
            state.revenue += revenueInput;
            state.expense += expenseInput;
            state.stock = state.stock + stockInInput - stockOutInput;
            
            // Sauvegarder dans le navigateur
            localStorage.setItem('rbl_total_revenue', state.revenue);
            localStorage.setItem('rbl_total_expense', state.expense);
            localStorage.setItem('rbl_current_stock', state.stock);

            // Réinitialiser les champs de saisie
            document.getElementById('input-revenue').value = '0.00';
            document.getElementById('input-expense').value = '0.00';
            document.getElementById('input-stock-in').value = '0';
            document.getElementById('input-stock-out').value = '0';
            
            updateDisplay();
            alert('Transaction sauvegardée localement !');
        }

        // ####################################################################
        // ########## LOGIQUE CALENDRIER ET ÉVÉNEMENTS ########################
        // ####################################################################

        const monthNames = ["Janvier", "Février", "Mars", "Avril", "Mai", "Juin", "Juillet", "Août", "Septembre", "Octobre", "Novembre", "Décembre"];

        function changeMonth(step) {
            currentMonth += step;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            } else if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            renderCalendar();
            document.getElementById('event-list').innerHTML = ''; // Nettoyer l'affichage de l'événement
            document.getElementById('event-date-title').textContent = 'Sélectionnez un jour';
            document.getElementById('event-list-message').style.display = 'block';
            selectedDate = null;
        }

        function renderCalendar() {
            document.getElementById('month-year-display').textContent = `${monthNames[currentMonth]} ${currentYear}`;
            const calendarGrid = document.getElementById('calendar-grid');
            
            // Nettoyer les jours (mais garder les noms des jours)
            const dayNamesCount = 7;
            while (calendarGrid.children.length > dayNamesCount) {
                calendarGrid.removeChild(calendarGrid.lastChild);
            }

            const firstDayOfMonth = new Date(currentYear, currentMonth, 1);
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            // getDay() renvoie 0 pour Dimanche, on veut 0 pour Lundi (Lundi=1, Dimanche=7)
            let startDay = firstDayOfMonth.getDay();
            if (startDay === 0) startDay = 7; // Convertir Dimanche (0) en 7
            let emptyDays = startDay - 1; // Nombre de jours vides avant le premier du mois

            // Jours vides
            for (let i = 0; i < emptyDays; i++) {
                const emptyDiv = document.createElement('div');
                emptyDiv.className = 'calendar-day empty-day';
                calendarGrid.appendChild(emptyDiv);
            }

            // Jours du mois
            for (let day = 1; day <= daysInMonth; day++) {
                const dateKey = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const dayDiv = document.createElement('div');
                dayDiv.className = 'calendar-day current-month';
                dayDiv.textContent = day;
                dayDiv.dataset.date = dateKey;
                dayDiv.onclick = () => selectDate(dayDiv, dateKey);

                // Marquer le jour actuel
                if (day === NOW.getDate() && currentMonth === NOW.getMonth() && currentYear === NOW.getFullYear()) {
                    dayDiv.classList.add('today');
                }
                
                // Marquer les jours avec des événements
                if (state.events[dateKey] && state.events[dateKey].length > 0) {
                    dayDiv.classList.add('has-event');
                }

                calendarGrid.appendChild(dayDiv);
            }
        }

        function selectDate(element, dateKey) {
            // Supprimer la sélection précédente
            document.querySelectorAll('.calendar-day').forEach(d => {
                d.style.backgroundColor = '';
            });

            // Ajouter la sélection actuelle
            element.style.backgroundColor = '#33334F';
            selectedDate = dateKey;
            
            renderEvents(dateKey);
        }

        function renderEvents(dateKey) {
            const events = state.events[dateKey] || [];
            const list = document.getElementById('event-list');
            const message = document.getElementById('event-list-message');
            document.getElementById('event-date-title').textContent = `Commandes pour le ${new Date(dateKey).toLocaleDateString('fr-FR', { day: 'numeric', month: 'long' })}`;
            list.innerHTML = '';
            
            if (events.length === 0) {
                message.style.display = 'block';
            } else {
                message.style.display = 'none';
                events.forEach((event, index) => {
                    const li = document.createElement('li');
                    li.textContent = event;
                    list.appendChild(li);
                });
            }
        }

        function addEvent() {
            if (!selectedDate) {
                alert("Veuillez d'abord sélectionner une date dans le calendrier.");
                return;
            }
            
            const input = document.getElementById('event-input');
            const eventText = input.value.trim();

            if (eventText) {
                if (!state.events[selectedDate]) {
                    state.events[selectedDate] = [];
                }
                state.events[selectedDate].push(eventText);
                
                // Sauvegarder dans localStorage
                localStorage.setItem('rbl_calendar_events', JSON.stringify(state.events));
                
                // Mettre à jour l'affichage
                renderEvents(selectedDate);
                renderCalendar(); // Pour ajouter le style 'has-event' au jour
                input.value = '';
                alert(`Commande planifiée pour le ${selectedDate} !`);
            }
        }
    </script>
</body>
</html>        /* ------------------------------------------------------------------ */
        /* INPUT PANEL */
        /* ------------------------------------------------------------------ */
        .input-panel { background: #151520; padding: 30px; border-radius: 10px; margin-bottom: 30px; }
        .input-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .input-group { margin-bottom: 15px; }
        .input-group label { display: block; font-size: 0.9em; margin-bottom: 5px; color: #FFD700; }
        .input-group input { width: 100%; padding: 12px; border-radius: 5px; border: 1px solid #333; background: #0A0A10; color: white; font-size: 1em; box-sizing: border-box; }
        #save-button { background: #FF0000; color: white; padding: 15px; border: none; border-radius: 5px; font-size: 1.1em; font-weight: bold; cursor: pointer; width: 100%; margin-top: 10px; transition: background 0.3s; }
        #save-button:hover { background: #cc0000; }

        /* ------------------------------------------------------------------ */
        /* CALENDAR STYLES */
        /* ------------------------------------------------------------------ */
        .calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .calendar-header button { background: none; border: none; color: #FFD700; font-size: 1.5em; cursor: pointer; }
        #month-year-display { font-size: 1.2em; font-weight: bold; }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); text-align: center; }
        .day-name { font-size: 0.8em; color: #AAAAAA; padding: 5px 0; }
        .calendar-day { 
            padding: 8px 0; 
            cursor: pointer; 
            border-radius: 50%; 
            transition: background 0.2s;
            position: relative;
        }
        .calendar-day:not(.empty-day):hover { background: #33334F; }
        .today { border: 2px solid #4CAF50; background: #223322 !important; color: #4CAF50; }
        .has-event { border: 2px solid #FF0000; }
        .current-month { color: #EAEAEA; }
        .other-month { color: #555555; }
        
        /* Event Display Panel */
        #event-display { margin-top: 25px; padding: 15px; background: #0A0A10; border-radius: 5px; min-height: 100px; }
        #event-display h3 { color: #FF0000; margin-top: 0; }
        #event-input { width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #333; background: #1C1C2C; color: white; margin-top: 10px; box-sizing: border-box;}
        #add-event-button { background: #FFD700; color: #121212; padding: 8px; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; margin-top: 10px; width: 100%; }
        #event-list { list-style: none; padding: 0; text-align: left; }
        #event-list li { margin-bottom: 5px; border-left: 3px solid #FF0000; padding-left: 10px; }

        /* ------------------------------------------------------------------ */
        /* SECURITY OVERLAY */
        /* ------------------------------------------------------------------ */
        #content-area { display: none; height: 100%; }
        #security-check { 
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); 
            max-width: 450px; padding: 40px; background: #1C1C2C; border-radius: 15px; 
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6); border: 1px solid #33334F; 
            text-align: center; color: #E0E0E0; z-index: 999; 
        }
    </style>
</head>
<body>
    <div id="security-check">
        <h1>🔐 Accès Sécurisé au Tableau de Bord</h1>
        <p>Accès refusé. Veuillez entrer le code mensuel pour déverrouiller cet outil de travail privé.</p>
        <input type="text" id="dashboard-code-input" placeholder="Code Mensuel (Ex: OCT2025)">
        <button onclick="checkCode()">Déverrouiller</button>
        <div id="security-result"></div>
    </div>
    
    <div id="content-area">
        <div class="dashboard-wrapper">
            
            <div class="sidebar">
                <p style="font-size: 0.9em; color: #AAAAAA; margin-bottom: 25px;">Code du mois : <span id="monthly-code" style="color: #4CAF50;"></span></p>

                <h2>🗓️ Calendrier des Commandes Planifiées</h2>
                
                <div class="calendar-header">
                    <button id="prev-month-button" onclick="changeMonth(-1)">&#9664;</button>
                    <span id="month-year-display"></span>
                    <button id="next-month-button" onclick="changeMonth(1)">&#9654;</button>
                </div>

                <div class="calendar-grid" id="calendar-grid">
                    <div class="day-name">Lun</div><div class="day-name">Mar</div><div class="day-name">Mer</div>
                    <div class="day-name">Jeu</div><div class="day-name">Ven</div><div class="day-name">Sam</div>
                    <div class="day-name">Dim</div>
                    </div>

                <div id="event-display">
                    <h3 id="event-date-title">Sélectionnez un jour</h3>
                    <p id="event-list-message" style="color:#FFD700; font-size:0.9em;">Aucune commande planifiée pour cette date.</p>
                    <ul id="event-list"></ul>
                    
                    <input type="text" id="event-input" placeholder="Ex: Commande 5 packs de Pierre" maxlength="50">
                    <button id="add-event-button" onclick="addEvent()">Ajouter la Commande</button>
                </div>

            </div>
            
            <div class="main-content">
                
                <h1>Espace de Travail - Gestion RBL LUXUURD</h1>
                <p id="current-datetime" style="color: #FFD700; font-weight: bold;"></p>

                <div class="widget-grid">
                    <div class="indicator-card" style="border-left: 5px solid #80CBC4;">
                        <h3>Revenus Totaux (€)</h3>
                        <p id="display-revenue">0.00</p>
                    </div>
                    <div class="indicator-card" style="border-left: 5px solid #FFCDD2;">
                        <h3>Dépenses Totales (€)</h3>
                        <p id="display-expense">0.00</p>
                    </div>
                    <div class="indicator-card" style="border-left: 5px solid #BBDEFB;">
                        <h3>Stock Actuel (Packs)</h3>
                        <p id="display-stock">0</p>
                    </div>
                </div>

                <div class="input-panel">
                    <h2>Enregistrement des Transactions</h2>
                    <div class="input-grid">
                        <div class="input-group">
                            <label for="input-revenue">Nouveau Revenu (€)</label>
                            <input type="number" id="input-revenue" placeholder="0.00" value="0.00">
                        </div>
                        <div class="input-group">
                            <label for="input-expense">Nouvelle Dépense (€)</label>
                            <input type="number" id="input-expense" placeholder="0.00" value="0.00">
                        </div>
                        <div class="input-group">
                            <label for="input-stock-in">Stock Reçu (+ Packs)</label>
                            <input type="number" id="input-stock-in" placeholder="0" value="0">
                        </div>
                        <div class="input-group">
                            <label for="input-stock-out">Stock Vendu (- Packs)</label>
                            <input type="number" id="input-stock-out" placeholder="0" value="0">
                        </div>
                    </div>
                    <button id="save-button" onclick="saveTransaction()">Ajouter Transaction & Mettre à jour les Totaux</button>
                    <p style="font-size: 0.8em; margin-top: 15px; color: #AAAAAA;">*Les totaux et les commandes du calendrier sont stockés dans le navigateur de cet appareil. Si vous effacez le cache, les données seront perdues.</p>
                </div>

            </div>
        </div>
    </div>

    <script>
        // ####################################################################
        // ########## PARAMÈTRES & SÉCURITÉ ###################################
        // ####################################################################
        const CORRECT_MONTHLY_CODE = "OCT2025"; 
        const NOW = new Date();
        let currentMonth = NOW.getMonth();
        let currentYear = NOW.getFullYear();
        let selectedDate = null;
        
        // Initialisation de l'état global
        let state = {
            revenue: 0,
            expense: 0,
            stock: 0,
            events: {} // Structure: {'YYYY-MM-DD': ['Event 1', 'Event 2']}
        };

        function checkCode() {
            const enteredCode = document.getElementById('dashboard-code-input').value.toUpperCase().trim();
            const resultElement = document.getElementById('security-result');

            if (enteredCode === CORRECT_MONTHLY_CODE) {
                document.getElementById('security-check').style.display = 'none';
                document.getElementById('content-area').style.display = 'block';
                localStorage.setItem('access_key_rbl', CORRECT_MONTHLY_CODE);
                loadData();
            } else {
                resultElement.textContent = "Code Invalide ou Expiré. ❌";
                resultElement.style.color = '#FF0000';
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            const savedKey = localStorage.getItem('access_key_rbl');
            if (savedKey === CORRECT_MONTHLY_CODE) {
                document.getElementById('security-check').style.display = 'none';
                document.getElementById('content-area').style.display = 'block';
                loadData();
            }
            document.getElementById('monthly-code').textContent = CORRECT_MONTHLY_CODE;
            updateDateTime();
            setInterval(updateDateTime, 1000); 
            renderCalendar();
        });
        
        function updateDateTime() {
            const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit' };
            const now = new Date();
            document.getElementById('current-datetime').textContent = `Date du jour : ${now.toLocaleDateString('fr-FR', dateOptions)} - ${now.toLocaleTimeString('fr-FR', timeOptions)}`;
        }

        // ####################################################################
        // ########## GESTION DES DONNÉES FINANCES/STOCK ######################
        // ####################################################################

        function loadData() {
            // Charge les totaux
            state.revenue = parseFloat(localStorage.getItem('rbl_total_revenue') || '0');
            state.expense = parseFloat(localStorage.getItem('rbl_total_expense') || '0');
            state.stock = parseInt(localStorage.getItem('rbl_current_stock') || '0');

            // Charge les événements du calendrier
            try {
                const storedEvents = localStorage.getItem('rbl_calendar_events');
                if (storedEvents) {
                    state.events = JSON.parse(storedEvents);
                }
            } catch (e) {
                console.error("Erreur lors du chargement des événements :", e);
                state.events = {};
            }
            
            updateDisplay();
            renderCalendar(); // Met à jour le calendrier après le chargement des événements
        }

        function updateDisplay() {
            document.getElementById('display-revenue').textContent = state.revenue.toFixed(2).replace('.', ',');
            document.getElementById('display-expense').textContent = state.expense.toFixed(2).replace('.', ',');
            document.getElementById('display-stock').textContent = state.stock;
        }

        function saveTransaction() {
            const revenueInput = parseFloat(document.getElementById('input-revenue').value) || 0;
            const expenseInput = parseFloat(document.getElementById('input-expense').value) || 0;
            const stockInInput = parseInt(document.getElementById('input-stock-in').value) || 0;
            const stockOutInput = parseInt(document.getElementById('input-stock-out').value) || 0;

            // Mettre à jour l'état
            state.revenue += revenueInput;
            state.expense += expenseInput;
            state.stock = state.stock + stockInInput - stockOutInput;
            
            // Sauvegarder dans le navigateur
            localStorage.setItem('rbl_total_revenue', state.revenue);
            localStorage.setItem('rbl_total_expense', state.expense);
            localStorage.setItem('rbl_current_stock', state.stock);

            // Réinitialiser les champs de saisie
            document.getElementById('input-revenue').value = '0.00';
            document.getElementById('input-expense').value = '0.00';
            document.getElementById('input-stock-in').value = '0';
            document.getElementById('input-stock-out').value = '0';
            
            updateDisplay();
            alert('Transaction sauvegardée localement !');
        }

        // ####################################################################
        // ########## LOGIQUE CALENDRIER ET ÉVÉNEMENTS ########################
        // ####################################################################

        const monthNames = ["Janvier", "Février", "Mars", "Avril", "Mai", "Juin", "Juillet", "Août", "Septembre", "Octobre", "Novembre", "Décembre"];

        function changeMonth(step) {
            currentMonth += step;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            } else if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            renderCalendar();
            document.getElementById('event-list').innerHTML = ''; // Nettoyer l'affichage de l'événement
            document.getElementById('event-date-title').textContent = 'Sélectionnez un jour';
            document.getElementById('event-list-message').style.display = 'block';
        }

        function renderCalendar() {
            document.getElementById('month-year-display').textContent = `${monthNames[currentMonth]} ${currentYear}`;
            const calendarGrid = document.getElementById('calendar-grid');
            
            // Nettoyer les jours (mais garder les noms des jours)
            const dayNamesCount = 7;
            while (calendarGrid.children.length > dayNamesCount) {
                calendarGrid.removeChild(calendarGrid.lastChild);
            }

            const firstDayOfMonth = new Date(currentYear, currentMonth, 1);
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            // getDay() renvoie 0 pour Dimanche, on veut 0 pour Lundi (Lundi=1, Dimanche=7)
            let startDay = firstDayOfMonth.getDay();
            if (startDay === 0) startDay = 7; // Convertir Dimanche (0) en 7
            let emptyDays = startDay - 1; // Nombre de jours vides avant le premier du mois

            // Jours vides
            for (let i = 0; i < emptyDays; i++) {
                const emptyDiv = document.createElement('div');
                emptyDiv.className = 'calendar-day empty-day';
                calendarGrid.appendChild(emptyDiv);
            }

            // Jours du mois
            for (let day = 1; day <= daysInMonth; day++) {
                const dateKey = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const dayDiv = document.createElement('div');
                dayDiv.className = 'calendar-day current-month';
                dayDiv.textContent = day;
                dayDiv.dataset.date = dateKey;
                dayDiv.onclick = () => selectDate(dayDiv, dateKey);

                // Marquer le jour actuel
                if (day === NOW.getDate() && currentMonth === NOW.getMonth() && currentYear === NOW.getFullYear()) {
                    dayDiv.classList.add('today');
                }
                
                // Marquer les jours avec des événements
                if (state.events[dateKey] && state.events[dateKey].length > 0) {
                    dayDiv.classList.add('has-event');
                }

                calendarGrid.appendChild(dayDiv);
            }
        }

        function selectDate(element, dateKey) {
            // Supprimer la sélection précédente
            document.querySelectorAll('.calendar-day').forEach(d => {
                d.style.backgroundColor = '';
            });

            // Ajouter la sélection actuelle
            element.style.backgroundColor = '#33334F';
            selectedDate = dateKey;
            
            renderEvents(dateKey);
        }

        function renderEvents(dateKey) {
            const events = state.events[dateKey] || [];
            const list = document.getElementById('event-list');
            const message = document.getElementById('event-list-message');
            document.getElementById('event-date-title').textContent = `Commandes pour le ${new Date(dateKey).toLocaleDateString('fr-FR', { day: 'numeric', month: 'long' })}`;
            list.innerHTML = '';
            
            if (events.length === 0) {
                message.style.display = 'block';
            } else {
                message.style.display = 'none';
                events.forEach((event, index) => {
                    const li = document.createElement('li');
                    li.textContent = event;
                    list.appendChild(li);
                });
            }
        }

        function addEvent() {
            if (!selectedDate) {
                alert("Veuillez d'abord sélectionner une date dans le calendrier.");
                return;
            }
            
            const input = document.getElementById('event-input');
            const eventText = input.value.trim();

            if (eventText) {
                if (!state.events[selectedDate]) {
                    state.events[selectedDate] = [];
                }
                state.events[selectedDate].push(eventText);
                
                // Sauvegarder dans localStorage
                localStorage.setItem('rbl_calendar_events', JSON.stringify(state.events));
                
                // Mettre à jour l'affichage
                renderEvents(selectedDate);
                renderCalendar(); // Pour ajouter le style 'has-event' au jour
                input.value = '';
                alert(`Commande planifiée pour le ${selectedDate} !`);
            }
        }
    </script>
</body>
</html>            cursor: pointer; 
            border-radius: 50%; 
            transition: background 0.2s;
            position: relative;
        }
        .calendar-day:not(.empty-day):hover { background: #33334F; }
        .today { border: 2px solid #4CAF50; background: #223322 !important; color: #4CAF50; }
        .has-event { border: 2px solid #FF0000; }
        .current-month { color: #EAEAEA; }
        .other-month { color: #555555; }
        
        /* Event Display Panel */
        #event-display { margin-top: 25px; padding: 15px; background: #0A0A10; border-radius: 5px; min-height: 100px; }
        #event-display h3 { color: #FF0000; margin-top: 0; }
        #event-input { width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #333; background: #1C1C2C; color: white; margin-top: 10px; box-sizing: border-box;}
        #add-event-button { background: #FFD700; color: #121212; padding: 8px; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; margin-top: 10px; width: 100%; }
        #event-list { list-style: none; padding: 0; text-align: left; }
        #event-list li { margin-bottom: 5px; border-left: 3px solid #FF0000; padding-left: 10px; }

        /* ------------------------------------------------------------------ */
        /* SECURITY OVERLAY */
        /* ------------------------------------------------------------------ */
        #content-area { display: none; height: 100%; }
        #security-check { 
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); 
            max-width: 450px; padding: 40px; background: #1C1C2C; border-radius: 15px; 
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6); border: 1px solid #33334F; 
            text-align: center; color: #E0E0E0; z-index: 999; 
        }
    </style>
</head>
<body>
    <div id="security-check">
        <h1>🔐 Accès Sécurisé au Tableau de Bord</h1>
        <p>Accès refusé. Veuillez entrer le code mensuel pour déverrouiller cet outil de travail privé.</p>
        <input type="text" id="dashboard-code-input" placeholder="Code Mensuel (Ex: OCT2025)">
        <button onclick="checkCode()">Déverrouiller</button>
        <div id="security-result"></div>
    </div>
    
    <div id="content-area">
        <div class="dashboard-wrapper">
            
            <div class="sidebar">
                <p style="font-size: 0.9em; color: #AAAAAA; margin-bottom: 25px;">Code du mois : <span id="monthly-code" style="color: #4CAF50;"></span></p>

                <h2>🗓️ Calendrier des Commandes Planifiées</h2>
                
                <div class="calendar-header">
                    <button id="prev-month-button" onclick="changeMonth(-1)">&#9664;</button>
                    <span id="month-year-display"></span>
                    <button id="next-month-button" onclick="changeMonth(1)">&#9654;</button>
                </div>

                <div class="calendar-grid" id="calendar-grid">
                    <div class="day-name">Lun</div><div class="day-name">Mar</div><div class="day-name">Mer</div>
                    <div class="day-name">Jeu</div><div class="day-name">Ven</div><div class="day-name">Sam</div>
                    <div class="day-name">Dim</div>
                    </div>

                <div id="event-display">
                    <h3 id="event-date-title">Sélectionnez un jour</h3>
                    <p id="event-list-message" style="color:#FFD700; font-size:0.9em;">Aucune commande planifiée pour cette date.</p>
                    <ul id="event-list"></ul>
                    
                    <input type="text" id="event-input" placeholder="Ex: Commande 5 packs de Pierre" maxlength="50">
                    <button id="add-event-button" onclick="addEvent()">Ajouter la Commande</button>
                </div>

            </div>
            
            <div class="main-content">
                
                <h1>Espace de Travail - Gestion RBL LUXUURD</h1>
                <p id="current-datetime" style="color: #FFD700; font-weight: bold;"></p>

                <div class="widget-grid">
                    <div class="indicator-card" style="border-left: 5px solid #80CBC4;">
                        <h3>Revenus Totaux (€)</h3>
                        <p id="display-revenue">0.00</p>
                    </div>
                    <div class="indicator-card" style="border-left: 5px solid #FFCDD2;">
                        <h3>Dépenses Totales (€)</h3>
                        <p id="display-expense">0.00</p>
                    </div>
                    <div class="indicator-card" style="border-left: 5px solid #BBDEFB;">
                        <h3>Stock Actuel (Packs)</h3>
                        <p id="display-stock">0</p>
                    </div>
                </div>

                <div class="input-panel">
                    <h2>Enregistrement des Transactions</h2>
                    <div class="input-grid">
                        <div class="input-group">
                            <label for="input-revenue">Nouveau Revenu (€)</label>
                            <input type="number" id="input-revenue" placeholder="0.00" value="0.00">
                        </div>
                        <div class="input-group">
                            <label for="input-expense">Nouvelle Dépense (€)</label>
                            <input type="number" id="input-expense" placeholder="0.00" value="0.00">
                        </div>
                        <div class="input-group">
                            <label for="input-stock-in">Stock Reçu (+ Packs)</label>
                            <input type="number" id="input-stock-in" placeholder="0" value="0">
                        </div>
                        <div class="input-group">
                            <label for="input-stock-out">Stock Vendu (- Packs)</label>
                            <input type="number" id="input-stock-out" placeholder="0" value="0">
                        </div>
                    </div>
                    <button id="save-button" onclick="saveTransaction()">Ajouter Transaction & Mettre à jour les Totaux</button>
                    <p style="font-size: 0.8em; margin-top: 15px; color: #AAAAAA;">*Les totaux et les commandes du calendrier sont stockés dans le navigateur de cet appareil. Si vous effacez le cache, les données seront perdues.</p>
                </div>

            </div>
        </div>
    </div>

    <script>
        // ####################################################################
        // ########## PARAMÈTRES & SÉCURITÉ ###################################
        // ####################################################################
        const CORRECT_MONTHLY_CODE = "OCT2025"; 
        const NOW = new Date();
        let currentMonth = NOW.getMonth();
        let currentYear = NOW.getFullYear();
        let selectedDate = null;
        
        // Initialisation de l'état global
        let state = {
            revenue: 0,
            expense: 0,
            stock: 0,
            events: {} // Structure: {'YYYY-MM-DD': ['Event 1', 'Event 2']}
        };

        function checkCode() {
            const enteredCode = document.getElementById('dashboard-code-input').value.toUpperCase().trim();
            const resultElement = document.getElementById('security-result');

            if (enteredCode === CORRECT_MONTHLY_CODE) {
                document.getElementById('security-check').style.display = 'none';
                document.getElementById('content-area').style.display = 'block';
                localStorage.setItem('access_key_rbl', CORRECT_MONTHLY_CODE);
                loadData();
            } else {
                resultElement.textContent = "Code Invalide ou Expiré. ❌";
                resultElement.style.color = '#FF0000';
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            const savedKey = localStorage.getItem('access_key_rbl');
            if (savedKey === CORRECT_MONTHLY_CODE) {
                document.getElementById('security-check').style.display = 'none';
                document.getElementById('content-area').style.display = 'block';
                loadData();
            }
            document.getElementById('monthly-code').textContent = CORRECT_MONTHLY_CODE;
            updateDateTime();
            setInterval(updateDateTime, 1000); 
            renderCalendar();
        });
        
        function updateDateTime() {
            const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit' };
            const now = new Date();
            document.getElementById('current-datetime').textContent = `Date du jour : ${now.toLocaleDateString('fr-FR', dateOptions)} - ${now.toLocaleTimeString('fr-FR', timeOptions)}`;
        }


        // ####################################################################
        // ########## GESTION DES DONNÉES FINANCES/STOCK ######################
        // ####################################################################

        function loadData() {
            // Charge les totaux
            state.revenue = parseFloat(localStorage.getItem('rbl_total_revenue') || '0');
            state.expense = parseFloat(localStorage.getItem('rbl_total_expense') || '0');
            state.stock = parseInt(localStorage.getItem('rbl_current_stock') || '0');

            // Charge les événements du calendrier
            try {
                const storedEvents = localStorage.getItem('rbl_calendar_events');
                if (storedEvents) {
                    state.events = JSON.parse(storedEvents);
                }
            } catch (e) {
                console.error("Erreur lors du chargement des événements :", e);
                state.events = {};
            }
            
            updateDisplay();
            renderCalendar(); // Met à jour le calendrier après le chargement des événements
        }

        function updateDisplay() {
            document.getElementById('display-revenue').textContent = state.revenue.toFixed(2).replace('.', ',');
            document.getElementById('display-expense').textContent = state.expense.toFixed(2).replace('.', ',');
            document.getElementById('display-stock').textContent = state.stock;
        }

        function saveTransaction() {
            const revenueInput = parseFloat(document.getElementById('input-revenue').value) || 0;
            const expenseInput = parseFloat(document.getElementById('input-expense').value) || 0;
            const stockInInput = parseInt(document.getElementById('input-stock-in').value) || 0;
            const stockOutInput = parseInt(document.getElementById('input-stock-out').value) || 0;

            // Mettre à jour l'état
            state.revenue += revenueInput;
            state.expense += expenseInput;
            state.stock = state.stock + stockInInput - stockOutInput;
            
            // Sauvegarder dans le navigateur
            localStorage.setItem('rbl_total_revenue', state.revenue);
            localStorage.setItem('rbl_total_expense', state.expense);
            localStorage.setItem('rbl_current_stock', state.stock);

            // Réinitialiser les champs de saisie
            document.getElementById('input-revenue').value = '0.00';
            document.getElementById('input-expense').value = '0.00';
            document.getElementById('input-stock-in').value = '0';
            document.getElementById('input-stock-out').value = '0';
            
            updateDisplay();
            alert('Transaction sauvegardée localement !');
        }

        // ####################################################################
        // ########## LOGIQUE CALENDRIER ET ÉVÉNEMENTS ########################
        // ####################################################################

        const monthNames = ["Janvier", "Février", "Mars", "Avril", "Mai", "Juin", "Juillet", "Août", "Septembre", "Octobre", "Novembre", "Décembre"];

        function changeMonth(step) {
            currentMonth += step;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            } else if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            renderCalendar();
            document.getElementById('event-list').innerHTML = ''; // Nettoyer l'affichage de l'événement
            document.getElementById('event-date-title').textContent = 'Sélectionnez un jour';
            document.getElementById('event-list-message').style.display = 'block';
        }

        function renderCalendar() {
            document.getElementById('month-year-display').textContent = `${monthNames[currentMonth]} ${currentYear}`;
            const calendarGrid = document.getElementById('calendar-grid');
            
            // Nettoyer les jours (mais garder les noms des jours)
            const dayNamesCount = 7;
            while (calendarGrid.children.length > dayNamesCount) {
                calendarGrid.removeChild(calendarGrid.lastChild);
            }

            const firstDayOfMonth = new Date(currentYear, currentMonth, 1);
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            // getDay() renvoie 0 pour Dimanche, on veut 0 pour Lundi (Lundi=1, Dimanche=7)
            let startDay = firstDayOfMonth.getDay();
            if (startDay === 0) startDay = 7; // Convertir Dimanche (0) en 7
            let emptyDays = startDay - 1; // Nombre de jours vides avant le premier du mois

            // Jours vides
            for (let i = 0; i < emptyDays; i++) {
                const emptyDiv = document.createElement('div');
                emptyDiv.className = 'calendar-day empty-day';
                calendarGrid.appendChild(emptyDiv);
            }

            // Jours du mois
            for (let day = 1; day <= daysInMonth; day++) {
                const dateKey = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const dayDiv = document.createElement('div');
                dayDiv.className = 'calendar-day current-month';
                dayDiv.textContent = day;
                dayDiv.dataset.date = dateKey;
                dayDiv.onclick = () => selectDate(dayDiv, dateKey);

                // Marquer le jour actuel
                if (day === NOW.getDate() && currentMonth === NOW.getMonth() && currentYear === NOW.getFullYear()) {
                    dayDiv.classList.add('today');
                }
                
                // Marquer les jours avec des événements
                if (state.events[dateKey] && state.events[dateKey].length > 0) {
                    dayDiv.classList.add('has-event');
                }

                calendarGrid.appendChild(dayDiv);
            }
        }

        function selectDate(element, dateKey) {
            // Supprimer la sélection précédente
            document.querySelectorAll('.calendar-day').forEach(d => {
                d.style.backgroundColor = '';
            });

            // Ajouter la sélection actuelle
            element.style.backgroundColor = '#33334F';
            selectedDate = dateKey;
            
            renderEvents(dateKey);
        }

        function renderEvents(dateKey) {
            const events = state.events[dateKey] || [];
            const list = document.getElementById('event-list');
            const message = document.getElementById('event-list-message');
            document.getElementById('event-date-title').textContent = `Commandes pour le ${new Date(dateKey).toLocaleDateString('fr-FR', { day: 'numeric', month: 'long' })}`;
            list.innerHTML = '';
            
            if (events.length === 0) {
                message.style.display = 'block';
            } else {
                message.style.display = 'none';
                events.forEach((event, index) => {
                    const li = document.createElement('li');
                    li.textContent = event;
                    list.appendChild(li);
                });
            }
        }

        function addEvent() {
            if (!selectedDate) {
                alert("Veuillez d'abord sélectionner une date dans le calendrier.");
                return;
            }
            
            const input = document.getElementById('event-input');
            const eventText = input.value.trim();

            if (eventText) {
                if (!state.events[selectedDate]) {
                    state.events[selectedDate] = [];
                }
                state.events[selectedDate].push(eventText);
                
                // Sauvegarder dans localStorage
                localStorage.setItem('rbl_calendar_events', JSON.stringify(state.events));
                
                // Mettre à jour l'affichage
                renderEvents(selectedDate);
                renderCalendar(); // Pour ajouter le style 'has-event' au jour
                input.value = '';
                alert(`Commande planifiée pour le ${selectedDate} !`);
            }
        }
    </script>
</body>
</html>        #event-input { width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #333; background: #1C1C2C; color: white; margin-top: 10px; box-sizing: border-box;}
        #add-event-button { background: #FFD700; color: #121212; padding: 8px; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; margin-top: 10px; width: 100%; }
        #event-list { list-style: none; padding: 0; text-align: left; }
        #event-list li { margin-bottom: 5px; border-left: 3px solid #FF0000; padding-left: 10px; }

        /* ------------------------------------------------------------------ */
        /* SECURITY OVERLAY */
        /* ------------------------------------------------------------------ */
        #content-area { display: none; height: 100%; }
        #security-check { 
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); 
            max-width: 450px; padding: 40px; background: #1C1C2C; border-radius: 15px; 
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6); border: 1px solid #33334F; 
            text-align: center; color: #E0E0E0; z-index: 999; 
        }
    </style>
</head>
<body>
    <div id="security-check">
        <h1>🔐 Accès Sécurisé au Tableau de Bord</h1>
        <p>Accès refusé. Veuillez entrer le code mensuel pour déverrouiller cet outil de travail privé.</p>
        <input type="text" id="dashboard-code-input" placeholder="Code Mensuel (Ex: OCT2025)">
        <button onclick="checkCode()">Déverrouiller</button>
        <div id="security-result"></div>
    </div>
    
    <div id="content-area">
        <div class="dashboard-wrapper">
            
            <div class="sidebar">
                <p style="font-size: 0.9em; color: #AAAAAA; margin-bottom: 25px;">Code du mois : <span id="monthly-code" style="color: #4CAF50;"></span></p>

                <h2>🗓️ Calendrier des Commandes Planifiées</h2>
                
                <div class="calendar-header">
                    <button id="prev-month-button" onclick="changeMonth(-1)">&#9664;</button>
                    <span id="month-year-display"></span>
                    <button id="next-month-button" onclick="changeMonth(1)">&#9654;</button>
                </div>

                <div class="calendar-grid" id="calendar-grid">
                    <div class="day-name">Lun</div><div class="day-name">Mar</div><div class="day-name">Mer</div>
                    <div class="day-name">Jeu</div><div class="day-name">Ven</div><div class="day-name">Sam</div>
                    <div class="day-name">Dim</div>
                    </div>

                <div id="event-display">
                    <h3 id="event-date-title">Sélectionnez un jour</h3>
                    <p id="event-list-message" style="color:#FFD700; font-size:0.9em;">Aucune commande planifiée pour cette date.</p>
                    <ul id="event-list"></ul>
                    
                    <input type="text" id="event-input" placeholder="Ex: Commande 5 packs de Pierre" maxlength="50">
                    <button id="add-event-button" onclick="addEvent()">Ajouter la Commande</button>
                </div>

            </div>
            
            <div class="main-content">
                
                <h1>Espace de Travail - Gestion RBL LUXUURD</h1>
                <p id="current-datetime" style="color: #FFD700; font-weight: bold;"></p>

                <div class="widget-grid">
                    <div class="indicator-card" style="border-left: 5px solid #80CBC4;">
                        <h3>Revenus Totaux (€)</h3>
                        <p id="display-revenue">0.00</p>
                    </div>
                    <div class="indicator-card" style="border-left: 5px solid #FFCDD2;">
                        <h3>Dépenses Totales (€)</h3>
                        <p id="display-expense">0.00</p>
                    </div>
                    <div class="indicator-card" style="border-left: 5px solid #BBDEFB;">
                        <h3>Stock Actuel (Packs)</h3>
                        <p id="display-stock">0</p>
                    </div>
                </div>

                <div class="input-panel">
                    <h2>Enregistrement des Transactions</h2>
                    <div class="input-grid">
                        <div class="input-group">
                            <label for="input-revenue">Nouveau Revenu (€)</label>
                            <input type="number" id="input-revenue" placeholder="0.00" value="0.00">
                        </div>
                        <div class="input-group">
                            <label for="input-expense">Nouvelle Dépense (€)</label>
                            <input type="number" id="input-expense" placeholder="0.00" value="0.00">
                        </div>
                        <div class="input-group">
                            <label for="input-stock-in">Stock Reçu (+ Packs)</label>
                            <input type="number" id="input-stock-in" placeholder="0" value="0">
                        </div>
                        <div class="input-group">
                            <label for="input-stock-out">Stock Vendu (- Packs)</label>
                            <input type="number" id="input-stock-out" placeholder="0" value="0">
                        </div>
                    </div>
                    <button id="save-button" onclick="saveTransaction()">Ajouter Transaction & Mettre à jour les Totaux</button>
                    <p style="font-size: 0.8em; margin-top: 15px; color: #AAAAAA;">*Les totaux et les commandes du calendrier sont stockés dans le navigateur de cet appareil. Si vous effacez le cache, les données seront perdues.</p>
                </div>

            </div>
        </div>
    </div>

    <script>
        // ####################################################################
        // ########## PARAMÈTRES & SÉCURITÉ ###################################
        // ####################################################################
        const CORRECT_MONTHLY_CODE = "OCT2025"; 
        const NOW = new Date();
        let currentMonth = NOW.getMonth();
        let currentYear = NOW.getFullYear();
        let selectedDate = null;
        
        // Initialisation de l'état global
        let state = {
            revenue: 0,
            expense: 0,
            stock: 0,
            events: {} // Structure: {'YYYY-MM-DD': ['Event 1', 'Event 2']}
        };

        function checkCode() {
            const enteredCode = document.getElementById('dashboard-code-input').value.toUpperCase().trim();
            const resultElement = document.getElementById('security-result');

            if (enteredCode === CORRECT_MONTHLY_CODE) {
                document.getElementById('security-check').style.display = 'none';
                document.getElementById('content-area').style.display = 'block';
                localStorage.setItem('access_key_rbl', CORRECT_MONTHLY_CODE);
                loadData();
            } else {
                resultElement.textContent = "Code Invalide ou Expiré. ❌";
                resultElement.style.color = '#FF0000';
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            const savedKey = localStorage.getItem('access_key_rbl');
            if (savedKey === CORRECT_MONTHLY_CODE) {
                document.getElementById('security-check').style.display = 'none';
                document.getElementById('content-area').style.display = 'block';
                loadData();
            }
            document.getElementById('monthly-code').textContent = CORRECT_MONTHLY_CODE;
            updateDateTime();
            setInterval(updateDateTime, 1000); 
            renderCalendar();
        });
        
        function updateDateTime() {
            const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit' };
            const now = new Date();
            document.getElementById('current-datetime').textContent = `Date du jour : ${now.toLocaleDateString('fr-FR', dateOptions)} - ${now.toLocaleTimeString('fr-FR', timeOptions)}`;
        }

        // ####################################################################
        // ########## GESTION DES DONNÉES FINANCES/STOCK ######################
        // ####################################################################

        function loadData() {
            // Charge les totaux
            state.revenue = parseFloat(localStorage.getItem('rbl_total_revenue') || '0');
            state.expense = parseFloat(localStorage.getItem('rbl_total_expense') || '0');
            state.stock = parseInt(localStorage.getItem('rbl_current_stock') || '0');

            // Charge les événements du calendrier
            try {
                const storedEvents = localStorage.getItem('rbl_calendar_events');
                if (storedEvents) {
                    state.events = JSON.parse(storedEvents);
                }
            } catch (e) {
                console.error("Erreur lors du chargement des événements :", e);
                state.events = {};
            }
            
            updateDisplay();
            renderCalendar(); // Met à jour le calendrier après le chargement des événements
        }

        function updateDisplay() {
            document.getElementById('display-revenue').textContent = state.revenue.toFixed(2).replace('.', ',');
            document.getElementById('display-expense').textContent = state.expense.toFixed(2).replace('.', ',');
            document.getElementById('display-stock').textContent = state.stock;
        }

        function saveTransaction() {
            const revenueInput = parseFloat(document.getElementById('input-revenue').value) || 0;
            const expenseInput = parseFloat(document.getElementById('input-expense').value) || 0;
            const stockInInput = parseInt(document.getElementById('input-stock-in').value) || 0;
            const stockOutInput = parseInt(document.getElementById('input-stock-out').value) || 0;

            // Mettre à jour l'état
            state.revenue += revenueInput;
            state.expense += expenseInput;
            state.stock = state.stock + stockInInput - stockOutInput;
            
            // Sauvegarder dans le navigateur
            localStorage.setItem('rbl_total_revenue', state.revenue);
            localStorage.setItem('rbl_total_expense', state.expense);
            localStorage.setItem('rbl_current_stock', state.stock);

            // Réinitialiser les champs de saisie
            document.getElementById('input-revenue').value = '0.00';
            document.getElementById('input-expense').value = '0.00';
            document.getElementById('input-stock-in').value = '0';
            document.getElementById('input-stock-out').value = '0';
            
            updateDisplay();
            alert('Transaction sauvegardée localement !');
        }

        // ####################################################################
        // ########## LOGIQUE CALENDRIER ET ÉVÉNEMENTS ########################
        // ####################################################################

        const monthNames = ["Janvier", "Février", "Mars", "Avril", "Mai", "Juin", "Juillet", "Août", "Septembre", "Octobre", "Novembre", "Décembre"];

        function changeMonth(step) {
            currentMonth += step;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            } else if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            renderCalendar();
            document.getElementById('event-list').innerHTML = ''; // Nettoyer l'affichage de l'événement
            document.getElementById('event-date-title').textContent = 'Sélectionnez un jour';
            document.getElementById('event-list-message').style.display = 'block';
        }

        function renderCalendar() {
            document.getElementById('month-year-display').textContent = `${monthNames[currentMonth]} ${currentYear}`;
            const calendarGrid = document.getElementById('calendar-grid');
            
            // Nettoyer les jours (mais garder les noms des jours)
            const dayNamesCount = 7;
            while (calendarGrid.children.length > dayNamesCount) {
                calendarGrid.removeChild(calendarGrid.lastChild);
            }

            const firstDayOfMonth = new Date(currentYear, currentMonth, 1);
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            // getDay() renvoie 0 pour Dimanche, on veut 0 pour Lundi (Lundi=1, Dimanche=7)
            let startDay = firstDayOfMonth.getDay();
            if (startDay === 0) startDay = 7; // Convertir Dimanche (0) en 7
            let emptyDays = startDay - 1; // Nombre de jours vides avant le premier du mois

            // Jours vides
            for (let i = 0; i < emptyDays; i++) {
                const emptyDiv = document.createElement('div');
                emptyDiv.className = 'calendar-day empty-day';
                calendarGrid.appendChild(emptyDiv);
            }

            // Jours du mois
            for (let day = 1; day <= daysInMonth; day++) {
                const dateKey = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const dayDiv = document.createElement('div');
                dayDiv.className = 'calendar-day current-month';
                dayDiv.textContent = day;
                dayDiv.dataset.date = dateKey;
                dayDiv.onclick = () => selectDate(dayDiv, dateKey);

                // Marquer le jour actuel
                if (day === NOW.getDate() && currentMonth === NOW.getMonth() && currentYear === NOW.getFullYear()) {
                    dayDiv.classList.add('today');
                }
                
                // Marquer les jours avec des événements
                if (state.events[dateKey] && state.events[dateKey].length > 0) {
                    dayDiv.classList.add('has-event');
                }

                calendarGrid.appendChild(dayDiv);
            }
        }

        function selectDate(element, dateKey) {
            // Supprimer la sélection précédente
            document.querySelectorAll('.calendar-day').forEach(d => {
                d.style.backgroundColor = '';
            });

            // Ajouter la sélection actuelle
            element.style.backgroundColor = '#33334F';
            selectedDate = dateKey;
            
            renderEvents(dateKey);
        }

        function renderEvents(dateKey) {
            const events = state.events[dateKey] || [];
            const list = document.getElementById('event-list');
            const message = document.getElementById('event-list-message');
            document.getElementById('event-date-title').textContent = `Commandes pour le ${new Date(dateKey).toLocaleDateString('fr-FR', { day: 'numeric', month: 'long' })}`;
            list.innerHTML = '';
            
            if (events.length === 0) {
                message.style.display = 'block';
            } else {
                message.style.display = 'none';
                events.forEach((event, index) => {
                    const li = document.createElement('li');
                    li.textContent = event;
                    list.appendChild(li);
                });
            }
        }

        function addEvent() {
            if (!selectedDate) {
                alert("Veuillez d'abord sélectionner une date dans le calendrier.");
                return;
            }
            
            const input = document.getElementById('event-input');
            const eventText = input.value.trim();

            if (eventText) {
                if (!state.events[selectedDate]) {
                    state.events[selectedDate] = [];
                }
                state.events[selectedDate].push(eventText);
                
                // Sauvegarder dans localStorage
                localStorage.setItem('rbl_calendar_events', JSON.stringify(state.events));
                
                // Mettre à jour l'affichage
                renderEvents(selectedDate);
                renderCalendar(); // Pour ajouter le style 'has-event' au jour
                input.value = '';
                alert(`Commande planifiée pour le ${selectedDate} !`);
            }
        }
    </script>
</body>
</html>







